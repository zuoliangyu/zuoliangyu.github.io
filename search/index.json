[{"content":"æ­£æ–‡æµ‹è¯• è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ï¼Œ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æ—¢ç„¶å¦‚ä½•ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ æˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹ä¸€ä¸ªéå¸¸å°´å°¬çš„äº‹å®ï¼Œé‚£å°±æ˜¯ï¼Œ å¯æ˜¯ï¼Œå³ä½¿æ˜¯è¿™æ ·ï¼Œå­¦ç”Ÿä¼šé€€ä¼šçš„å‡ºç°ä»ç„¶ä»£è¡¨äº†ä¸€å®šçš„æ„ä¹‰ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œå‘ç”Ÿäº†ä¼šå¦‚ä½•ï¼Œä¸å‘ç”Ÿåˆä¼šå¦‚ä½•ã€‚ ç»è¿‡ä¸Šè¿°è®¨è®ºï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ è¿™æ ·çœ‹æ¥ï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å°±æˆ‘ä¸ªäººæ¥è¯´ï¼Œå­¦ç”Ÿä¼šé€€ä¼šå¯¹æˆ‘çš„æ„ä¹‰ï¼Œä¸èƒ½ä¸è¯´éå¸¸é‡å¤§ã€‚ èå£«æ¯”äºšæ›¾ç»æåˆ°è¿‡ï¼Œäººçš„ä¸€ç”Ÿæ˜¯çŸ­çš„ï¼Œä½†å¦‚æœå‘åŠ£åœ°è¿‡è¿™ä¸€ç”Ÿï¼Œå°±å¤ªé•¿äº†ã€‚è¿™ä¼¼ä¹è§£ç­”äº†æˆ‘çš„ç–‘æƒ‘ã€‚ è«æ‰ç‰¹è¯´è¿‡ä¸€å¥å¯Œæœ‰å“²ç†çš„è¯ï¼Œè°å’Œæˆ‘ä¸€æ ·ç”¨åŠŸï¼Œè°å°±ä¼šå’Œæˆ‘ä¸€æ ·æˆåŠŸã€‚è¿™å¯å‘äº†æˆ‘ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ äº†è§£æ¸…æ¥šå­¦ç”Ÿä¼šé€€ä¼šåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ï¼Œæ˜¯è§£å†³ä¸€åˆ‡é—®é¢˜çš„å…³é”®ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ã€‚\nå¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸºæ›¾ç»è¯´è¿‡ï¼Œå…±åŒçš„äº‹ä¸šï¼Œå…±åŒçš„æ–—äº‰ï¼Œå¯ä»¥ä½¿äººä»¬äº§ç”Ÿå¿å—ä¸€åˆ‡çš„åŠ›é‡ã€‚ã€€å¸¦ç€è¿™å¥è¯ï¼Œæˆ‘ä»¬è¿˜è¦æ›´åŠ æ…é‡çš„å®¡è§†è¿™ä¸ªé—®é¢˜ï¼š ä¸€èˆ¬æ¥è®²ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»åŠ¡å¿…æ…é‡çš„è€ƒè™‘è€ƒè™‘ã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æˆ‘è®¤ä¸ºï¼Œ æˆ‘è®¤ä¸ºï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ è¦æƒ³æ¸…æ¥šï¼Œå­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ã€‚ æˆ‘è®¤ä¸ºï¼Œ æ—¢ç„¶å¦‚æ­¤ï¼Œ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ é‚£ä¹ˆï¼Œ æˆ‘è®¤ä¸ºï¼Œ å­¦ç”Ÿä¼šé€€ä¼šå› ä½•è€Œå‘ç”Ÿã€‚\nå¼•ç”¨ æ€å¿µæ˜¯æœ€æš–çš„å¿§ä¼¤åƒä¸€åŒç¿…è†€\nè®©æˆ‘åœä¸äº†é£ä¸è¿œåœ¨è¿‡å¾€æ¸¸è¡\nä¸å‘Šè€Œåˆ«çš„ä½  å°±ç®—ä¸ºäº†æˆ‘ç€æƒ³\nè¿™ä¹ˆæ²‰ç—›çš„å‘µæŠ¤ æˆ‘æ€ä¹ˆèƒ½ç¿±ç¿”\næœ€æš–çš„æ†‚å‚· - ç”°é¦¥ç”„\nå›¾ç‰‡ 1 2 3 ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg) ![Photo by Luca Bravo on Unsplash](luca-bravo-alS7ewQ41M8-unsplash.jpg) ![Photo by Helena Hertz on Unsplash](helena-hertz-wWZzXlDpMog-unsplash.jpg) ![Photo by Hudai Gayiran on Unsplash](hudai-gayiran-3Od_VKcDEAA-unsplash.jpg) ç›¸å†Œè¯­æ³•æ¥è‡ª Typlog\n","date":"2020-09-09T00:00:00Z","image":"https://zuoliangyu.github.io/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu4699868770670889127.jpg","permalink":"https://zuoliangyu.github.io/p/test-chinese/","title":"Chinese Test"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2019-03-11T00:00:00Z","image":"https://zuoliangyu.github.io/p/markdown-syntax-guide/pawel-czerwinski-8uZPynIu-rQ-unsplash_hu6307248181568134095.jpg","permalink":"https://zuoliangyu.github.io/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"},{"content":"Lorem est tota propiore conpellat pectoribus de pectora summo.\nRedit teque digerit hominumque toris verebor lumina non cervice subde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc caluere tempus inhospita parcite confusaque translucet patri vestro qui optatis lumine cognoscere flos nubis! Fronde ipsamque patulos Dryopen deorum.\nExierant elisi ambit vivere dedere Duce pollice Eris modo Spargitque ferrea quos palude Rursus nulli murmur; hastile inridet ut ab gravi sententia! Nomine potitus silentia flumen, sustinet placuit petis in dilapsa erat sunt. Atria tractus malis.\nComas hunc haec pietate fetum procerum dixit Post torum vates letum Tiresia Flumen querellas Arcanaque montibus omnes Quidem et Vagus elidunt The Van de Graaf Canon\nMane refeci capiebant unda mulcebat Victa caducifer, malo vulnere contra dicere aurato, ludit regale, voca! Retorsit colit est profanae esse virescere furit nec; iaculi matertera et visa est, viribus. Divesque creatis, tecta novat collumque vulnus est, parvas. Faces illo pepulere tempus adest. Tendit flamma, ab opes virum sustinet, sidus sequendo urbis.\nIubar proles corpore raptos vero auctor imperium; sed et huic: manus caeli Lelegas tu lux. Verbis obstitit intus oblectamina fixis linguisque ausus sperare Echionides cornuaque tenent clausit possit. Omnia putatur. Praeteritae refert ausus; ferebant e primus lora nutat, vici quae mea ipse. Et iter nil spectatae vulnus haerentia iuste et exercebat, sui et.\nEurytus Hector, materna ipsumque ut Politen, nec, nate, ignari, vernum cohaesit sequitur. Vel mitis temploque vocatus, inque alis, oculos nomen non silvis corpore coniunx ne displicet illa. Crescunt non unus, vidit visa quantum inmiti flumina mortis facto sic: undique a alios vincula sunt iactata abdita! Suspenderat ego fuit tendit: luna, ante urbem Propoetides parte.\n","date":"2019-03-09T00:00:00Z","image":"https://zuoliangyu.github.io/p/placeholder-text/matt-le-SJSpo9hQf7s-unsplash_hu10664154974910995856.jpg","permalink":"https://zuoliangyu.github.io/p/placeholder-text/","title":"Placeholder Text"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTeX globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTeX on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples Inline math: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$\nBlock math: $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$\n","date":"2019-03-08T00:00:00Z","permalink":"https://zuoliangyu.github.io/p/math-typesetting/","title":"Math Typesetting"},{"content":"Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your site\u0026rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nğŸ™ˆ :see_no_evil: ğŸ™‰ :hear_no_evil: ğŸ™Š :speak_no_evil:\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3 .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; } ","date":"2019-03-05T00:00:00Z","image":"https://zuoliangyu.github.io/p/emoji-support/the-creative-exchange-d2zvqp3fpro-unsplash_hu5876398126655421130.jpg","permalink":"https://zuoliangyu.github.io/p/emoji-support/","title":"Emoji Support"},{"content":"[toc]\nå‰è¨€ å°å°çš„bbå‡ å¥ è¿™é‡Œæˆ‘è¯´æ˜ä¸€ä¸‹æˆ‘ä¸ªäººåœ¨å­¦ä¹ å•ç‰‡æœºçš„æ—¶å€™çš„ä¸€äº›å¿ƒå¾—ä½“ä¼šï¼Œä»¥åŠå¤§æ¨¡æ¿çš„æœ€æ–°å»ºç«‹ï¼Œä¼šæŒç»­æ›´æ–°ã€‚\næœ€åŸºç¡€çš„æ¨¡ç‰ˆæ¥è‡ªäºBç«™Up Alice_è¥¿é£çš„ä¸ªäººç©ºé—´-Alice_è¥¿é£ä¸ªäººä¸»é¡µ-å“”å“©å“”å“©è§†é¢‘ (bilibili.com)\næˆ‘çš„Bç«™ä¸ºå·¦-å²šçš„ä¸ªäººç©ºé—´-å·¦-å²šä¸ªäººä¸»é¡µ-å“”å“©å“”å“©è§†é¢‘ (bilibili.com)\nè¿™ç¯‡æ–‡ç« å¯¹åº”ç€æˆ‘Bç«™çš„è§†é¢‘ä¸º ã€è“æ¡¥æ¯ã€‘ã€å•ç‰‡æœºã€‘å¤§æ¨¡æ¿æ„å»ºå–‚é¥­æ•™ç¨‹\nå»ºè®®æ­é…ç€è§†é¢‘ä½¿ç”¨ï¼Œä¸ç„¶å¯èƒ½æœ‰äº›åœ°æ–¹æ¯”è¾ƒè¿·ç³Šã€‚\nç”¨åˆ°çš„å‹ç¼©åŒ…å’Œè¿™ä¸ªpdfçš„ç™¾åº¦ç½‘ç›˜é“¾æ¥\né“¾æ¥ï¼šhttps://pan.baidu.com/s/1LhlBR7eKAB4A4sbvkHtiJw?pwd=mvin æå–ç ï¼šmvin \u0026ndash;æ¥è‡ªç™¾åº¦ç½‘ç›˜è¶…çº§ä¼šå‘˜V4çš„åˆ†äº«\nå¯¹åº”çš„CSDNé“¾æ¥ä¸ºã€å–‚é¥­ã€‘ã€é€Ÿæˆã€‘è“æ¡¥æ¯æ¨¡ç‰ˆæ‰‹æŠŠæ‰‹å»ºç«‹-CSDNåšå®¢\nå¯¹åº”çš„çŸ¥ä¹é“¾æ¥ä¸ºã€å–‚é¥­ã€‘ã€é€Ÿæˆã€‘è“æ¡¥æ¯æ¨¡ç‰ˆæ‰‹æŠŠæ‰‹å»ºç«‹\nè¿™ä¸¤ä¸ªä»“åº“å¯ä»¥åˆ é™¤åé¢çš„ä¸œè¥¿ï¼ˆä¸€ç›´åˆ é™¤åˆ°masterï¼Œå¯ä»¥çœ‹åˆ°æˆ‘çš„å…¨éƒ¨çš„ä¸œè¥¿ï¼‰\nGithubçš„ä»“åº“ä¸º lanqiaobei_study/æ¨¡æ¿/demo_zuolan at master Â· zuoliangyu/lanqiaobei_study (github.com) Giteeçš„ä»“åº“ä¸º æ¨¡æ¿/demo_zuolan Â· zuoliangyu/è“æ¡¥æ¯å­¦ä¹  - ç äº‘ - å¼€æºä¸­å›½ (gitee.com)\né”å­˜å™¨ä¸ä¸‰å…«è¯‘ç å™¨ä»‹ç» è¿™é‡Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªåŸºç¡€çŸ¥è¯†ï¼Œå°±æ˜¯æˆ‘ä»¬çš„é”å­˜å™¨å’Œä¸‰å…«è¯‘ç å™¨ä»‹ç»ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå…³é”®çš„ç‚¹ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸‹é¢è¿™ä¸¤ä¸ªå›¾ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„é”å­˜å™¨æ˜¯ç”¨P25ï¼ŒP26ï¼ŒP27è¿›è¡Œæ§åˆ¶ï¼Œå³P2çš„é«˜ä¸‰ä½è¿›è¡Œçš„æ§åˆ¶ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§å¦‚ä¸‹çš„å‘½ä»¤è¿›è¡Œä¹¦å†™å³å¯ã€‚\n1 2 P2 = P2 \u0026amp; 0x1f | 0x?0; P2 \u0026amp;= 0x1f; å…¶ä¸­çš„P2\u0026amp;=0x1fï¼Œè¡¨ç¤ºæˆ‘ä»¬å°†é«˜ä¸‰ä½ç½®ä¸º0ï¼Œ| 0x?0çš„æ“ä½œè¡¨æ˜æˆ‘ä»¬å¯¹é«˜ä¸‰ä½è¿›è¡Œä¹¦å†™ï¼Œæ¯”å¦‚Y4Cï¼Œé‚£ä¹ˆå°±ä»£è¡¨æˆ‘ä»¬çš„é«˜ä¸‰ä½è¦è¡¨ç¤ºä¸º4ï¼Œå³0100ï¼Œæˆ‘ä»¬å°†å…¶æ”¾åœ¨é«˜ä½ï¼Œå³1000_0000ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯0x80\nNOPå»¶æ—¶å‡½æ•° è¿™é‡Œè¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬å»¶æ—¶å‡½æ•°å¤§éƒ¨åˆ†éƒ½æœ‰NOPï¼ŒåŒ…æ‹¬Ds1302ï¼ŒIICéƒ½ä½¿ç”¨äº†è¿™ä¸ªï¼Œè¿™ä¸ªå‡½æ•°å­˜åœ¨äºå¤´æ–‡ä»¶intrins.hä¸­ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹å¼•ç”¨ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªNOPåœ¨12MHzçš„å•ç‰‡æœºä¸‹æ˜¯1usï¼Œå…¶ä½™çš„è‡ªå·±å»æ¢ç®—ä¸€ä¸‹ã€‚\nLEDï¼Œèœ‚é¸£å™¨ï¼Œç»§ç”µå™¨ï¼ŒMOTORæ¨¡ç‰ˆå»ºç«‹ Led.c è¿™é‡Œè™½ç„¶åç§°å«åšLed.cï¼Œä½†æ˜¯é‡Œé¢ä¹¦å†™LEDï¼Œèœ‚é¸£å™¨ï¼Œç»§ç”µå™¨ï¼ŒMOTORçš„ä»£ç \nLedåº•å±‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Ledçš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°çš„æ˜¯ï¼Œè¿™ä¸ªåœ°æ–¹ä½¿ç”¨äº†staticè¿™ä¸ªå…³é”®è¯ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å…³æ³¨å†…å­˜çš„ä½¿ç”¨~~ï¼ˆè¿™é‡Œä¸å¾—ä¸æC51çš„åƒåœ¾å†…å­˜å®¹é‡ï¼‰~~ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶å˜ä¸ºå‡½æ•°é™æ€å†…å­˜ï¼Œå¯ä»¥æœ‰æ•ˆèŠ‚çœã€‚\nä¼ å…¥çš„å‚æ•°æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯addrï¼Œä»£è¡¨æˆ‘ä»¬éœ€è¦æ§åˆ¶çš„Ledçš„åœ°å€ï¼Œï¼ˆ0-7ï¼‰å¯¹åº”äº†ï¼ˆL1-L8ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯enableï¼Œç”¨äºæ§åˆ¶é€‰ä¸­çš„Ledç¯çš„äº®ç­ã€‚\n1 void Led_Disp(unsigned char addr, unsigned char enable) æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯tempï¼Œä¸€ä¸ªæ˜¯temp_oldï¼Œä½ ä»¬å¯èƒ½ä¼šå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆæˆ‘è¦åœ¨è¿™é‡Œç”¨ä¸¤ä¸ªå˜é‡æ¥è¿›è¡Œç¼–å†™ï¼Œæ˜æ˜é€»è¾‘ä¸Šåªéœ€è¦ç”¨ä¸€ä¸ªå˜é‡å¯¹P0è¿›è¡Œèµ‹å€¼å°±è¡Œäº†ï¼Œè¿™é‡Œæˆ‘è¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šä¸€ç›´æ“æ§é”å­˜å™¨ï¼Œå¦åˆ™æœ‰æ¦‚ç‡å½±å“æ•°ç ç®¡çš„æ˜¾ç¤ºï¼Œå½“æˆ‘ä»¬çŠ¶å†µå‡ºç°å˜åŒ–ï¼ˆtemp!=temp_oldï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰å¯¹é”å­˜å™¨P2çš„é«˜ä¸‰ä½è¿›è¡Œä¹¦å†™ã€‚å½“æˆ‘ä»¬éœ€è¦ç‚¹äº®çš„æ—¶å€™ï¼Œå°±è®©ç›¸åº”çš„addrå˜ä¸º1ï¼›å½“æˆ‘ä»¬éœ€è¦ç†„ç­çš„æ—¶å€™å°±è®©ç›¸åº”çš„addrå˜ä¸º0ï¼›\nè¿™é‡Œä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨åŸç†å›¾ä¸Šé¢å¦‚æœæƒ³è®©Ledäº®ï¼Œé‚£ä¹ˆåº”è¯¥ç»™0ï¼Œè¿™é‡Œåšä¸€ä¸ªè¯´æ˜ï¼Œæˆ‘ä»¬åé¢ä¼šç›´æ¥å–åï¼Œè¿™é‡Œç”¨1æ˜¯ä¸ºäº†ç¬¦åˆæˆ‘ä»¬çš„ç›´è§‰~~ï¼ˆå› ä¸ºæ­£å¸¸äººå°±æ˜¯1äº®0ç­ï¼‰~~\n1 2 3 4 5 6 static unsigned char temp = 0x00; static unsigned char temp_old = 0xff; if (enable) temp |= 0x01 \u0026lt;\u0026lt; addr; else temp \u0026amp;= ~(0x01 \u0026lt;\u0026lt; addr); æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹åŸç†å›¾å¯ä»¥çœ‹åˆ°ï¼Œç”¨äºæ§åˆ¶çš„Loadä¸ºY4Cï¼Œæˆ‘ä»¬é€šè¿‡è®¡ç®—äºŒè¿›åˆ¶å¯ä»¥å‘ç°ç»“æœä¸º1000_0000ï¼Œå³0x80ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œä»£ç ä¸­çš„P2è®¾ç½®ä¸ºP2 = P2 \u0026amp; 0x1f | 0x80;åœ¨è¿è¡Œååˆ«å¿˜è®°ä½¿ç”¨P2 \u0026amp;= 0x1fæ¥è¿›è¡Œé«˜ä½æ¸…é›¶ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬æ“ä½œP2é”å­˜å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹P0è¿›è¡Œèµ‹å€¼ï¼ˆè¦è®°å¾—å…ˆå–åï¼‰\n1 2 3 4 5 6 if (temp != temp_old) { P0 = ~temp; P2 = P2 \u0026amp; 0x1f | 0x80; P2 \u0026amp;= 0x1f; temp_old = temp; } å®Œæ•´ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /// @brief Ledæ‰«æ /// @param addr éœ€è¦æ§åˆ¶çš„Ledçš„åœ°å€ï¼ˆ0-7ï¼‰ /// @param enable æ§åˆ¶è¯¥åœ°å€çš„Ledæ˜¯å¦ç‚¹äº® void Led_Disp(unsigned char addr, unsigned char enable) { static unsigned char temp = 0x00; static unsigned char temp_old = 0xff; if (enable) temp |= 0x01 \u0026lt;\u0026lt; addr; else temp \u0026amp;= ~(0x01 \u0026lt;\u0026lt; addr); if (temp != temp_old) { P0 = ~temp; P2 = P2 \u0026amp; 0x1f | 0x80; P2 \u0026amp;= 0x1f; temp_old = temp; } } èœ‚é¸£å™¨ï¼Œç»§ç”µå™¨ï¼ŒMOTORåº•å±‚ è¿™é‡Œæˆ‘å°±ä¸€èµ·è®²äº†ï¼Œå› ä¸ºä»–ä»¬ä¸‰æ˜¯ä¸€ä¸ªèŠ¯ç‰‡çš„ä¸åŒè¾“å‡ºï¼Œå’Œä¸Šæ–¹çš„Ledç±»ä¼¼ï¼Œä½†æ˜¯è¿™å‡ ä¸ªéœ€è¦ä¸€ä¸ªå…¨å±€å˜é‡ï¼ˆåœ¨å‡½æ•°å¤–ç”³æ˜ï¼‰\n1 2 unsigned char temp_0 = 0x00; unsigned char temp_old_0 = 0xff; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒBUZZã€MOTORã€RELAYä¸ºä¸€ä¸ªèŠ¯ç‰‡çš„ä¸åŒä½çš„è¾“å‡º\nRELAYå¯¹åº”I5-\u0026gt;Q4-\u0026gt;D4-\u0026gt;0001_0000-\u0026gt;0x10\nMOTORå¯¹åº”I6-\u0026gt;Q5-\u0026gt;D5-\u0026gt;0010_0000-\u0026gt;0x20\nBUZZå¯¹åº”I7-\u0026gt;Q6-\u0026gt;D6-\u0026gt;0100_0000-\u0026gt;0x80\nè¿™é‡Œåæˆ‘ä»¬å°±çŸ¥é“å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹åº”çš„å·¥ä½œï¼Œé‚£ä¹ˆå°±è¦ç»™P0èµ‹ç›¸åº”çš„å€¼ï¼Œå¹¶ä¸”ä¸‹æ–¹çš„Y5Cä¹Ÿå‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬éœ€è¦ç»™é”å­˜å™¨ä¸º1010_0000-\u0026gt;0xa0,å³P2 = P2 \u0026amp; 0x1f | 0xa0;è¿™ä¸ªä¹‹åä¹Ÿåˆ«å¿˜äº†ä½¿ç”¨P2 \u0026amp;= 0x1fæ¥è¿›è¡Œé«˜ä½æ¸…é›¶ã€‚\n1 2 3 4 5 6 if (temp_0 != temp_old_0) { P0 = temp_0; P2 = P2 \u0026amp; 0x1f | 0xa0; P2 \u0026amp;= 0x1f; temp_old_0 = temp_0; } æ€»ä½“ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 unsigned char temp_0 = 0x00; unsigned char temp_old_0 = 0xff; /// @brief èœ‚é¸£å™¨æ§åˆ¶ /// @param enable void Beep(bit enable) { if (enable) temp_0 |= 0x40; else temp_0 \u0026amp;= ~(0x40); if (temp_0 != temp_old_0) { P0 = temp_0; P2 = P2 \u0026amp; 0x1f | 0xa0; P2 \u0026amp;= 0x1f; temp_old_0 = temp_0; } } /// @brief ç»§ç”µå™¨æ§åˆ¶ /// @param enable void Relay(bit enable) { if (enable) temp_0 |= 0x10; else temp_0 \u0026amp;= ~(0x10); if (temp_0 != temp_old_0) { P0 = temp_0; P2 = P2 \u0026amp; 0x1f | 0xa0; P2 \u0026amp;= 0x1f; temp_old_0 = temp_0; } } /// @brief MOTORæ§åˆ¶ /// @param enable void MOTOR(bit enable) { if (enable) temp_0 |= 0x20; else temp_0 \u0026amp;= ~(0x20); if (temp_0 != temp_old_0) { P0 = temp_0; P2 = P2 \u0026amp; 0x1f | 0xa0; P2 \u0026amp;= 0x1f; temp_old_0 = temp_0; } } Led.h ç”³æ˜ä»£ç å¦‚ä¸‹\n1 2 3 4 5 #include \u0026lt;STC15F2K60S2.H\u0026gt; void Led_Disp(unsigned char addr, unsigned char enable); void Beep(bit enable); void Relay(bit enable); void MOTOR(bit enable); Keyæ¨¡ç‰ˆå»ºç«‹ key.c åŸºç¡€ä»£ç  åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŸç†å›¾é‡Œé¢çš„è¡Œåˆ—æ˜¾ç¤ºï¼Œæœ€æ–°ç‰ˆçš„åŸç†å›¾æŠŠrowå’Œcolå•ç‹¬æ‹¿å‡ºæ¥äº†ï¼Œæ‰€ä»¥å¯èƒ½å¯¹åº”æœ‰ç‚¹éº»çƒ¦~~ï¼ˆå…¶å®ä¹Ÿä¸éº»çƒ¦ï¼‰~~ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç›´æ¥æŒ‰ç…§ä¸€åˆ—ä¸€åˆ—è¿›è¡Œæ‰«æï¼Œç»™åˆ—ä½ç”µå¹³ååˆ¤æ–­æŒ‡å®šè¡Œæ˜¯å¦ä¸ºä½ç”µå¹³ï¼Œå¦‚æœæŒ‡å®šè¡Œä¸ºä½ç”µå¹³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹ã€‚å¹¶ä¸”æˆ‘ä»¬åœ¨è¿™é‡Œä¸éœ€è¦å®ç°æ¶ˆæŠ–ç­‰æ“ä½œï¼Œæˆ‘ä»¬ä¼šåœ¨main.cé‡Œé¢å®ç°æˆ‘ä»¬çš„åŠŸèƒ½ï¼Œè¿™é‡Œåªå®ç°æœ€åŸºç¡€çš„æ‰«æã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 P44 = 0;P42 = 1;P35 = 1;P34 = 1; if (P33 == 0) temp = 4; if (P32 == 0) temp = 5; if (P31 == 0) temp = 6; if (P30 == 0) temp = 7; P44 = 1;P42 = 0;P35 = 1;P34 = 1; if (P33 == 0) temp = 8; if (P32 == 0) temp = 9; if (P31 == 0) temp = 10; if (P30 == 0) temp = 11; P44 = 1;P42 = 1;P35 = 0;P34 = 1; if (P33 == 0) temp = 12; if (P32 == 0) temp = 13; if (P31 == 0) temp = 14; if (P30 == 0) temp = 15; P44 = 1;P42 = 1;P35 = 1;P34 = 0; if (P33 == 0) temp = 16; if (P32 == 0) temp = 17; if (P31 == 0) temp = 18; if (P30 == 0) temp = 19; åœ¨æˆ‘ä»¬æŠŠè¡Œåˆ—æ‰«æå†™å®Œåå°±å¯ä»¥å®Œæˆå·¥ä½œäº†ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå±€éƒ¨å˜é‡ä¸€å®šè¦æ³¨æ„åˆå§‹åŒ–ä¸º0\n1 unsigned char temp = 0; æ³¨æ„äº‹é¡¹ åœ¨è¿™é‡Œè¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çš„ä¸²å£è¿›è¡Œå‘é€çš„æ—¶å€™ä¼šå ç”¨P30å’ŒP31å£ï¼Œè¿™ä¸ªæ˜¯ç¡¬ä»¶çš„å†²çªï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿›å…¥è¿™ä¸ªæ‰«æå‡½æ•°çš„æ—¶å€™ï¼Œéœ€è¦å¯¹å…¶å…³æ‰è½®è¯¢ï¼ˆå°±æ˜¯åœ¨mainå‡½æ•°é‡Œé¢ç”¨çš„ä»€ä¹ˆæ¥è¿›è¡Œå„ä¸ªå‡½æ•°å®šæ—¶çš„å®šæ—¶å™¨ï¼Œå«åšè½®è¯¢å®šæ—¶å™¨ï¼‰ã€‚è¿™é‡Œæˆ‘ç”¨çš„æ˜¯å®šæ—¶å™¨1ï¼Œæ‰€ä»¥æˆ‘è¿›å…¥åå°±è¦ä½¿ç”¨ET1=0å…³æ‰ï¼Œç»“æŸåç”¨P3=0xffï¼›ET1=1å¼€å¯ã€‚\n1 2 3 4 ET1 = 0; ---- P3 = 0xff; ET1 = 1; è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„é—®é¢˜ï¼Œä»Šå¹´ï¼ˆ2024ï¼‰ä¸ç®¡æ˜¯çœèµ›è¿˜æ˜¯å›½èµ›éƒ½è€ƒäº†ne555çš„æµ‹é‡ï¼Œæˆ‘ä»¬ne555çš„æµ‹é‡è¦ç”¨åˆ°P34å¼•è„šï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„æŒ‰é”®çš„æœ€åä¸€åˆ—ï¼Œé‚£ä¹ˆè¿™é‡Œå°±è¦æ³¨æ„ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªç¡¬ä»¶å†²çªï¼Œä¸”æ— æ³•è§£å†³ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æ‰€æœ‰P34åˆ é™¤ï¼Œå°±å½“æˆ‘ä»¬ç”¨çš„æŒ‰é”®ä¸º4è¡Œ3åˆ—\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 P44 = 0;P42 = 1;P35 = 1; if (P33 == 0) temp = 4; if (P32 == 0) temp = 5; if (P31 == 0) temp = 6; if (P30 == 0) temp = 7; P44 = 1;P42 = 0;P35 = 1; if (P33 == 0) temp = 8; if (P32 == 0) temp = 9; if (P31 == 0) temp = 10; if (P30 == 0) temp = 11; P44 = 1;P42 = 1;P35 = 0; if (P33 == 0) temp = 12; if (P32 == 0) temp = 13; if (P31 == 0) temp = 14; if (P30 == 0) temp = 15; æ•´ä½“ä»£ç å¦‚ä¸‹ï¼ˆæ²¡æœ‰åŒ…æ‹¬ne555ï¼Œå¦‚æœæœ‰ne555éœ€è¦æŠŠæŒ‰é”®æ‰«ææ¢æˆä¸Šé¢çš„ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 #include \u0026#34;key.h\u0026#34; unsigned char Key_Read() { unsigned char temp = 0; ET1 = 0; P44 = 0;P42 = 1;P35 = 1;P34 = 1; if (P33 == 0) temp = 4; if (P32 == 0) temp = 5; if (P31 == 0) temp = 6; if (P30 == 0) temp = 7; P44 = 1;P42 = 0;P35 = 1;P34 = 1; if (P33 == 0) temp = 8; if (P32 == 0) temp = 9; if (P31 == 0) temp = 10; if (P30 == 0) temp = 11; P44 = 1;P42 = 1;P35 = 0;P34 = 1; if (P33 == 0) temp = 12; if (P32 == 0) temp = 13; if (P31 == 0) temp = 14; if (P30 == 0) temp = 15; P44 = 1;P42 = 1;P35 = 1;P34 = 0; if (P33 == 0) temp = 16; if (P32 == 0) temp = 17; if (P31 == 0) temp = 18; if (P30 == 0) temp = 19; P3 = 0xff; ET1 = 1; return temp; } key.h 1 2 #include \u0026lt;STC15F2K60S2.H\u0026gt; unsigned char Key_Read(); æ•°ç ç®¡æ¨¡æ¿å»ºç«‹ Seg.c æ•°ç ç®¡ç¼–ç æ¨å¯¼ è¿™é‡Œæˆ‘å•ç‹¬å¼€ä¸€ä¸ªæ ‡é¢˜æ¥åšæ•°ç ç®¡çš„ç¼–ç æ¨å¯¼ï¼Œå› ä¸ºè¿™ä¸ªå¾ˆé‡è¦ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸‹æ–¹çš„æˆªå›¾\nå¯ä»¥è§‚å¯Ÿåˆ°æ¯ä¸€æ®µçš„æ•°ç ç®¡éƒ½è¢«ç¼–å·ï¼Œè¿™é‡Œç”±äºæˆ‘ä»¬ç”¨çš„æ˜¯å…±é˜³ææ•°ç ç®¡ï¼Œå³0äº®1ç­ï¼Œä¸‹é¢æˆ‘ç»™ä¸€ä¸ªğŸŒ°æ¥è¿›è¡Œè¯´æ˜\næˆ‘ä»¬æ ‡å¥½åæŒ‰ç…§dp-\u0026gt;g-\u0026gt;â€¦-\u0026gt;açš„é¡ºåºå†™å‡ºï¼Œå³1010_0100-\u0026gt;0xa4ï¼Œè¿™ä¸ªå€¼åœ¨æ•°ç ç®¡çš„æ˜¾ç¤ºä¸­å°±ä»£è¡¨ç€â€œ2â€\næ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªè§„å¾‹æ¥ç¼–å†™ä¸€ä¸ªæ®µé€‰è¡¨\n1 2 code unsigned char seg_dula[] = {0xc0, 0xf9, 0xa4, 0xb0, 0x99, 0x92, 0x82, 0xf8, 0x80, 0x90, 0xff, 0x88}; æ•°ç ç®¡ä»£ç ç¼–å†™ è¿™æ˜¯æˆ‘ä»¬æœ€æœ€é‡è¦çš„ç©æ„ï¼Œå› ä¸ºè¿™ä¸ªæ¶‰åŠåˆ°æˆ‘ä»¬çš„æ˜¾ç¤ºï¼Œæˆ‘ä»¬çœ‹åŸç†å›¾å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°ç ç®¡è¿›è¡Œä½é€‰ï¼ˆé€‰æ‹©å“ªä¸€ä¸ªæ•°ç ç®¡è¿›è¡Œæ˜¾ç¤ºï¼‰ï¼Œæ®µé€‰ï¼ˆé€‰æ‹©æ•°ç ç®¡æ˜¾ç¤ºçš„æ•°æ®ï¼‰ã€‚\nå…¶ä¸­ABCDEFGå’ŒDPä¸ºæˆ‘ä»¬çš„æ®µé€‰ï¼ŒCOM1-8ä¸ºæˆ‘ä»¬çš„ä½é€‰\næˆ‘ä»¬éœ€è¦å…ˆå¯¹P0è¿›è¡Œæ®µé€‰æ˜¾ç¤ºåï¼Œä½¿ç”¨P2å°†é”å­˜å™¨æ‰“å¼€ï¼ˆY7C-\u0026gt;1110_0000-\u0026gt;0xe0ï¼‰;åœ¨å¯¹P0è¿›è¡Œä½é€‰é…ç½®åï¼Œä½¿ç”¨P2å°†é”å­˜å™¨æ‰“å¼€ï¼ˆY6C-\u0026gt;1100_0000-\u0026gt;0xc0ï¼‰\nç»è¿‡æˆ‘ä»¬çš„åˆ†æåæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“æˆ‘ä»¬éœ€è¦ä¼ å…¥çš„æ•°æ®ä¸ºwelaä½é€‰ï¼Œdulaæ®µé€‰ï¼Œpointæ˜¯å¦æ˜¾ç¤ºå°æ•°ç‚¹\n1 void Seg_Disp(unsigned char wela, unsigned char dula, unsigned char point) æˆ‘ä»¬ä¸ºäº†é¿å…é—ªçƒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆå¯¹æ•°ç ç®¡è¿›è¡Œæ¶ˆéšï¼Œå³\n1 2 3 P0 = 0xff; P2 = P2 \u0026amp; 0x1f | 0xe0; P2 \u0026amp;= 0x1f; ç„¶åæˆ‘ä»¬å¯¹ä½ç½®è¿›è¡Œé€‰æ‹©åä½¿ç”¨P2æ‰“å¼€ç›¸åº”é”å­˜å™¨\n1 2 3 P0 = 0x01 \u0026lt;\u0026lt; wela; P2 = P2 \u0026amp; 0x1f | 0xc0; P2 \u0026amp;= 0x1f; ç”±äºæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¦æ˜¾ç¤ºå°æ•°ç‚¹çš„è¯ï¼Œæˆ‘ä»¬å°±è¦è®©DPä¸º0ï¼Œå…¶ä»–ä¸å˜ï¼Œå³\u0026amp;0x7få³å¯å®Œæˆ\n1 2 3 4 P0 = seg_dula[dula]; if (point) P0 \u0026amp;= 0x7f; P2 = P2 \u0026amp; 0x1f | 0xe0; P2 \u0026amp;= 0x1f; æ€»ä½“ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include \u0026#34;seg.h\u0026#34; // 0-9 ç­ // A code unsigned char seg_dula[] = {0xc0, 0xf9, 0xa4, 0xb0, 0x99, 0x92, 0x82, 0xf8, 0x80, 0x90, 0xff, 0x88}; void Seg_Disp(unsigned char wela, unsigned char dula, unsigned char point) { // æ¶ˆéš P0 = 0xff; P2 = P2 \u0026amp; 0x1f | 0xe0; P2 \u0026amp;= 0x1f; // ä½é€‰ P0 = 0x01 \u0026lt;\u0026lt; wela; P2 = P2 \u0026amp; 0x1f | 0xc0; P2 \u0026amp;= 0x1f; // æ®µé€‰ P0 = seg_dula[dula]; if (point) P0 \u0026amp;= 0x7f; P2 = P2 \u0026amp; 0x1f | 0xe0; P2 \u0026amp;= 0x1f; } Seg.h 1 2 #include \u0026lt;STC15F2K60S2.H\u0026gt; void Seg_Disp(unsigned char wela, unsigned char dula, unsigned char point); Ds1302æ—¶é’Ÿæ¨¡ç‰ˆå»ºç«‹ Ds1302.c è¿™é‡Œæœ‰å®˜æ–¹æä¾›çš„å‚è€ƒä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šé¢çš„æ—¶åºå¯ä»¥ä¸ç”¨ä¹¦å†™ï¼Œæˆ‘ä»¬ç›´æ¥å¯¹ä¸‹æ–¹çš„æ—¶é—´è¯»å–/å†™å…¥è¿›è¡Œæ“ä½œ\nå®˜æ–¹çš„å‚è€ƒä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 /*\t# DS1302ä»£ç ç‰‡æ®µè¯´æ˜ 1. æœ¬æ–‡ä»¶å¤¹ä¸­æä¾›çš„é©±åŠ¨ä»£ç ä¾›å‚èµ›é€‰æ‰‹å®Œæˆç¨‹åºè®¾è®¡å‚è€ƒã€‚ 2. å‚èµ›é€‰æ‰‹å¯ä»¥è‡ªè¡Œç¼–å†™ç›¸å…³ä»£ç æˆ–ä»¥è¯¥ä»£ç ä¸ºåŸºç¡€ï¼Œæ ¹æ®æ‰€é€‰å•ç‰‡æœºç±»å‹ã€è¿è¡Œé€Ÿåº¦å’Œè¯•é¢˜ ä¸­å¯¹å•ç‰‡æœºæ—¶é’Ÿé¢‘ç‡çš„è¦æ±‚ï¼Œè¿›è¡Œä»£ç è°ƒè¯•å’Œä¿®æ”¹ã€‚ */ // void Write_Ds1302(unsigned char temp) { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { SCK = 0; SDA = temp \u0026amp; 0x01; temp \u0026gt;\u0026gt;= 1; SCK = 1; } } // void Write_Ds1302_Byte(unsigned char address, unsigned char dat) { RST = 0; _nop_(); SCK = 0; _nop_(); RST = 1; _nop_(); Write_Ds1302(address); Write_Ds1302(dat); RST = 0; } // unsigned char Read_Ds1302_Byte(unsigned char address) { unsigned char i, temp = 0x00; RST = 0; _nop_(); SCK = 0; _nop_(); RST = 1; _nop_(); Write_Ds1302(address); for (i = 0; i \u0026lt; 8; i++) { SCK = 0; temp \u0026gt;\u0026gt;= 1; if (SDA) temp |= 0x80; SCK = 1; } RST = 0; _nop_(); SCK = 0; _nop_(); SCK = 1; _nop_(); SDA = 0; _nop_(); SDA = 1; _nop_(); return (temp); } æˆ‘ä»¬éœ€è¦è¡¥å……çš„ä»£ç  é¦–å…ˆæ˜¯æˆ‘ä»¬éœ€è¦ç»‘å®šSDAï¼ŒRSTï¼ŒSCKçš„å¼•è„šï¼Œåœ¨åŸç†å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¹¶ä¸”è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†NOPå‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥å¤´æ–‡ä»¶intrins.h\n1 2 3 4 #include \u0026#34;intrins.h\u0026#34; sbit SDA = P2 ^ 3; sbit RST = P1 ^ 3; sbit SCK = P1 ^ 7; ç„¶åå°±æ˜¯æˆ‘ä»¬çš„è¯»å†™æ—¶é’Ÿï¼Œè§‚å¯ŸèŠ¯ç‰‡æ‰‹å†Œå¯ä»¥çœ‹åˆ°\næˆ‘ä»¬å¦‚æœéœ€è¦è¯»å–æ—¶é’Ÿçš„è¯ï¼Œåªéœ€è¦è¯»å–åœ°å€0x85-\u0026gt;å°æ—¶ 0x83-\u0026gt;åˆ†é’Ÿ 0x81-\u0026gt;ç§’é’Ÿ\næˆ‘ä»¬å¦‚æœéœ€è¦å†™å…¥æ—¶é’Ÿçš„è¯ï¼Œéœ€è¦å…ˆå°†0x8Eä½ç½®çš„æœ€é«˜ä½WPç½®0ï¼Œè§£é™¤å†™ä¿æŠ¤åæ‰èƒ½è¿›è¡Œå†™å…¥ï¼Œå†™å…¥çš„åœ°å€ä¸º0x84-\u0026gt;å°æ—¶ 0x82-\u0026gt;åˆ†é’Ÿ 0x80-\u0026gt;ç§’é’Ÿ\næ‰€ä»¥æˆ‘ä»¬çš„ä»£ç ç¼–å†™å°±å¾ˆç®€å•äº†,æˆ‘ä»¬ä¼ å…¥æ•°æ®ä¸ºæ•°ç»„çš„æŒ‡é’ˆ\n1 2 void Set_Rtc(unsigned char *ucRtc) void Read_Rtc(unsigned char *ucRtc) è¿™é‡Œç»™ä¸€ä¸ªè°ƒç”¨çš„ç¤ºä¾‹\n1 2 3 unsigned char time[3] = {11,12,13};//11:12:13 Set_Rtc(time); Read_Rtc(time); æˆ‘ä»¬åœ¨å†™å…¥ä¹‹å‰éœ€è¦è¿›è¡Œè§£é”å†™ä¿æŠ¤ï¼Œå†™å®Œåå°±è¿›è¡Œå†™ä¿æŠ¤\n1 2 3 Write_Ds1302_Byte(0x8e, 0x00); ----- Write_Ds1302_Byte(0x8e, 0x80); æˆ‘ä»¬åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨forå¾ªç¯è¿›è¡Œè¯»å–/å†™å…¥ï¼Œç”±äºæˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨åè¿›åˆ¶è¿›è¡Œå­˜å‚¨å’Œè¯»å–ï¼ˆæœ¬è´¨ä¸Šå­˜å‚¨å’Œè¯»å–çš„éƒ½æ˜¯äºŒè¿›åˆ¶BCDç ï¼Œæ¯”å¦‚0x11æˆ‘ä»¬è¯»å–ä¸º11ï¼Œå†™å…¥ä¸º11ï¼Œåœ¨é‡Œé¢å†…éƒ¨ä½¿ç”¨å˜é‡è¿›è¡Œè½¬æ¢ï¼‰\nä¸¾ä¸ªğŸŒ°ï¼Œæˆ‘ä»¬å‡è®¾è¦å†™å…¥çš„æ—¶é—´ä¸º23:59:58ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®é™…ä¸Šè¦å†™å…¥èŠ¯ç‰‡çš„æ•°æ®ä¸º0x23 0x59 0x58\nä½†æ˜¯æˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿ï¼ˆå› ä¸ºæœ‰æ—¶å€™éœ€è¦æˆ‘ä»¬æ˜¯è®¾ç½®æ—¶é’Ÿï¼ŒåŠ å‡çš„é‚£ç§ï¼Œç›´æ¥ä½¿ç”¨bcdç ä¸æ–¹ä¾¿ï¼Œéœ€è¦æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦è¾¾åˆ°0xa0ç„¶åè¿›è¡Œè½¬æ¢ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢å†™ä¸€ä¸ªåè¿›åˆ¶è½¬ä¸ºåè¿›åˆ¶bcdç çš„å…¬å¼å°±è¡Œï¼Œä»¥å†™å…¥0x23ä¸ºä¾‹ï¼Œæˆ‘ä»¬è¾“å…¥ç»™æˆ‘ä»¬Set_Rtcå‡½æ•°çš„æ•°æ®ä¸º23ï¼Œæˆ‘ä»¬è¦å…ˆå°†å…¶è½¬æ¢ä¸º0x23æ‰èƒ½è¿›è¡Œå†™å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä¸€ä¸‹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æŠŠåä½å’Œä¸ªä½åˆ†å¼€ï¼Œç„¶åå†å­˜å…¥å³å¯ï¼Œæˆ‘ä»¬åˆ†å¼€å¾ˆç®€å•ï¼Œç›´æ¥/10å’Œ%10å°±å¯ä»¥å–å‡ºåä½å’Œä¸ªä½ï¼Œç„¶åå†ä½¿ç”¨\u0026laquo;4æ¥è¿›è¡Œé«˜ä½ç§»ä½ï¼Œå°†æˆ‘ä»¬çš„åä½ç§»åŠ¨åˆ°é«˜å››ä½å»ï¼Œç„¶å|ä¸Šæˆ‘ä»¬çš„ä¸ªä½ï¼ˆä½å››ä½ï¼‰å°±å¯ä»¥å°†å…¶æ‹¼æ¥å®Œæˆã€‚\n23-\u0026gt;2,3-\u0026gt;0010,0011-\u0026gt;0100_0011\n1 temp = ucRtc[i] / 10 \u0026lt;\u0026lt; 4 | ucRtc[i] % 10; åŒç†ï¼Œæˆ‘ä»¬è¯»å–çš„æ—¶å€™è¯»å–åˆ°çš„éƒ½æ˜¯åè¿›åˆ¶çš„bcdç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å…¶è½¬æ¢åå†è¯»å‡º\n0x23-\u0026gt;0x2,0x3-\u0026gt;2*10+3-\u0026gt;23\n1 ucRtc[i] = temp \u0026gt;\u0026gt; 4 * 10 + temp \u0026amp; 0x0f; è¯»å–å’Œå†™å…¥çš„ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 //å†™å…¥ for (i = 0; i \u0026lt; 3; i++) { temp = ucRtc[i] / 10 \u0026lt;\u0026lt; 4 | ucRtc[i] % 10; Write_Ds1302_Byte(0x84 - 2 * i, temp); } //è¯»å– for (i = 0; i \u0026lt; 3; i++) { temp = Read_Ds1302_Byte(0x85 - 2 * i); ucRtc[i] = temp \u0026gt;\u0026gt; 4 * 10 + temp \u0026amp; 0x0f; } éœ€è¦è¡¥å……çš„å®Œæ•´ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // åè¿›åˆ¶ 11 -\u0026gt; 0x11 void Set_Rtc(unsigned char *ucRtc) { unsigned char i; unsigned char temp; Write_Ds1302_Byte(0x8e, 0x00); for (i = 0; i \u0026lt; 3; i++) { temp = ucRtc[i] / 10 \u0026lt;\u0026lt; 4 | ucRtc[i] % 10; Write_Ds1302_Byte(0x84 - 2 * i, temp); } Write_Ds1302_Byte(0x8e, 0x80); } // åè¿›åˆ¶ 0x11 -\u0026gt; 11 void Read_Rtc(unsigned char *ucRtc) { unsigned char i; unsigned char temp; for (i = 0; i \u0026lt; 3; i++) { temp = Read_Ds1302_Byte(0x85 - 2 * i); ucRtc[i] = temp \u0026gt;\u0026gt; 4 * 10 + temp \u0026amp; 0x0f; } } å®Œæ•´ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 /*\t# DS1302ä»£ç ç‰‡æ®µè¯´æ˜ 1. æœ¬æ–‡ä»¶å¤¹ä¸­æä¾›çš„é©±åŠ¨ä»£ç ä¾›å‚èµ›é€‰æ‰‹å®Œæˆç¨‹åºè®¾è®¡å‚è€ƒã€‚ 2. å‚èµ›é€‰æ‰‹å¯ä»¥è‡ªè¡Œç¼–å†™ç›¸å…³ä»£ç æˆ–ä»¥è¯¥ä»£ç ä¸ºåŸºç¡€ï¼Œæ ¹æ®æ‰€é€‰å•ç‰‡æœºç±»å‹ã€è¿è¡Œé€Ÿåº¦å’Œè¯•é¢˜ ä¸­å¯¹å•ç‰‡æœºæ—¶é’Ÿé¢‘ç‡çš„è¦æ±‚ï¼Œè¿›è¡Œä»£ç è°ƒè¯•å’Œä¿®æ”¹ã€‚ */ #include \u0026#34;ds1302.h\u0026#34; #include \u0026#34;intrins.h\u0026#34; sbit SDA = P2 ^ 3; sbit RST = P1 ^ 3; sbit SCK = P1 ^ 7; // void Write_Ds1302(unsigned char temp) { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { SCK = 0; SDA = temp \u0026amp; 0x01; temp \u0026gt;\u0026gt;= 1; SCK = 1; } } // void Write_Ds1302_Byte(unsigned char address, unsigned char dat) { RST = 0; _nop_(); SCK = 0; _nop_(); RST = 1; _nop_(); Write_Ds1302(address); Write_Ds1302(dat); RST = 0; } // unsigned char Read_Ds1302_Byte(unsigned char address) { unsigned char i, temp = 0x00; RST = 0; _nop_(); SCK = 0; _nop_(); RST = 1; _nop_(); Write_Ds1302(address); for (i = 0; i \u0026lt; 8; i++) { SCK = 0; temp \u0026gt;\u0026gt;= 1; if (SDA) temp |= 0x80; SCK = 1; } RST = 0; _nop_(); SCK = 0; _nop_(); SCK = 1; _nop_(); SDA = 0; _nop_(); SDA = 1; _nop_(); return (temp); } // åè¿›åˆ¶ 11 -\u0026gt; 0x11 void Set_Rtc(unsigned char *ucRtc) { unsigned char i; unsigned char temp; Write_Ds1302_Byte(0x8e, 0x00); for (i = 0; i \u0026lt; 3; i++) { temp = ucRtc[i] / 10 \u0026lt;\u0026lt; 4 | ucRtc[i] % 10; Write_Ds1302_Byte(0x84 - 2 * i, temp); } Write_Ds1302_Byte(0x8e, 0x80); } // åè¿›åˆ¶ 0x11 -\u0026gt; 11 void Read_Rtc(unsigned char *ucRtc) { unsigned char i; unsigned char temp; for (i = 0; i \u0026lt; 3; i++) { temp = Read_Ds1302_Byte(0x85 - 2 * i); ucRtc[i] = temp \u0026gt;\u0026gt; 4 * 10 + temp \u0026amp; 0x0f; } } Ds1302.h 1 2 3 #include \u0026lt;STC15F2K60S2.H\u0026gt; void Set_Rtc(unsigned char *ucRtc); void Read_Rtc(unsigned char *ucRtc); Onewireæ¸©åº¦æ¨¡ç‰ˆå»ºç«‹ Onewire.c å®˜æ–¹çš„å‚è€ƒä»£ç  è¿™é‡Œæœ‰å®˜æ–¹æä¾›çš„å‚è€ƒä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šé¢çš„æ—¶åºå¯ä»¥ä¸ç”¨ä¹¦å†™ï¼Œæˆ‘ä»¬ç›´æ¥å¯¹ä¸‹æ–¹çš„è¿›è¡Œæ¸©åº¦è¯»å–æ“ä½œã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 /*\t# å•æ€»çº¿ä»£ç ç‰‡æ®µè¯´æ˜ 1. æœ¬æ–‡ä»¶å¤¹ä¸­æä¾›çš„é©±åŠ¨ä»£ç ä¾›å‚èµ›é€‰æ‰‹å®Œæˆç¨‹åºè®¾è®¡å‚è€ƒã€‚ 2. å‚èµ›é€‰æ‰‹å¯ä»¥è‡ªè¡Œç¼–å†™ç›¸å…³ä»£ç æˆ–ä»¥è¯¥ä»£ç ä¸ºåŸºç¡€ï¼Œæ ¹æ®æ‰€é€‰å•ç‰‡æœºç±»å‹ã€è¿è¡Œé€Ÿåº¦å’Œè¯•é¢˜ ä¸­å¯¹å•ç‰‡æœºæ—¶é’Ÿé¢‘ç‡çš„è¦æ±‚ï¼Œè¿›è¡Œä»£ç è°ƒè¯•å’Œä¿®æ”¹ã€‚ */ // void Delay_OneWire(unsigned int t) { unsigned char i; while (t--) { for (i = 0; i \u0026lt; 12; i++); } } // void Write_DS18B20(unsigned char dat) { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { DQ = 0; DQ = dat \u0026amp; 0x01; Delay_OneWire(5); DQ = 1; dat \u0026gt;\u0026gt;= 1; } Delay_OneWire(5); } // unsigned char Read_DS18B20(void) { unsigned char i; unsigned char dat; for (i = 0; i \u0026lt; 8; i++) { DQ = 0; dat \u0026gt;\u0026gt;= 1; DQ = 1; if (DQ) { dat |= 0x80; } Delay_OneWire(5); } return dat; } // bit init_ds18b20(void) { bit initflag = 0; DQ = 1; Delay_OneWire(12); DQ = 0; Delay_OneWire(80); DQ = 1; Delay_OneWire(10); initflag = DQ; Delay_OneWire(5); return initflag; } æˆ‘ä»¬éœ€è¦è¡¥å……çš„ä»£ç  é¦–å…ˆæ˜¯æˆ‘ä»¬éœ€è¦ç»‘å®šDQçš„å¼•è„šï¼Œåœ¨åŸç†å›¾ä¸­å¯ä»¥çœ‹åˆ°\n1 sbit DQ = P1 ^ 4; æˆ‘ä»¬ä¸éœ€è¦ç®¡ä¸Šæ–¹çš„æ—¶åºçš„ä¹¦å†™ï¼Œåªéœ€è¦è¿›è¡Œæ¸©åº¦è¯»å–çš„ä»£ç ä¹¦å†™å°±è¡Œï¼Œ\nä¸‹æ–¹æ˜¯æ¸©åº¦èŠ¯ç‰‡çš„ä½¿ç”¨é¡ºåºï¼ˆå®˜æ–¹æ‰‹å†Œï¼‰ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦è¿è¡Œinitï¼Œç„¶åå†æ£€æŸ¥romï¼ˆå¯è·³è¿‡ï¼‰ï¼Œæœ€åæ‰§è¡Œæˆ‘ä»¬çš„åŠŸèƒ½å‡½æ•°ï¼Œæ³¨æ„ï¼Œä¸€æ¬¡åªèƒ½ä½¿ç”¨ä¸€ä¸ªåŠŸèƒ½ã€‚\næˆ‘ä»¬å¯ä»¥åœ¨å®˜æ–¹æ‰‹å†Œä¸Šæ‰¾åˆ°éœ€è¦è¿è¡Œçš„æŒ‡ä»¤\nå½“æˆ‘ä»¬å‘é€0xccçš„æ—¶å€™ï¼Œå°±ä¼šè·³è¿‡ROMæ£€æŸ¥ï¼Œå¹¶ä¸”è¿™é‡Œä¹Ÿè¯´æ˜äº†ï¼Œæˆ‘ä»¬å‘é€0x44å°±å¯ä»¥å¼€å¯æ¸©åº¦è½¬æ¢ï¼Œå‘é€0xbeå°±å¯ä»¥å¼€å§‹è¯»å–æ¸©åº¦ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸€ä¸ªäº‹æƒ…ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥åœ¨æˆ‘ä»¬çš„å®˜æ–¹çš„æ‰‹å†Œä¸Šé¢æ‰¾åˆ°ä¸€æ®µè¯»å–çš„è¯­å¥ï¼Œè¿™é‡Œè¡¨æ˜æˆ‘ä»¬å…ˆè¯»å–ä½ä½ï¼Œå†è¯»å–é«˜ä½ï¼Œæœ€åå°†å…¶æ‹¼æ¥åå†*ç²¾åº¦å°±æ˜¯æˆ‘ä»¬çš„æ•°æ®äº†\næ¸©åº¦çš„ç²¾åº¦åœ¨æ–‡æ¡£ä¸­å¯¹åº”å¦‚ä¸‹\nç²¾åº¦ä¸º9-\u0026gt;0.5;10-\u0026gt;0.25;11-\u0026gt;0.125;12ï¼ˆé»˜è®¤ï¼‰-\u0026gt;0.0625\næˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ä¸Šé¢çš„æè¿°æ¥è¿›è¡Œä»£ç ä¹¦å†™\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 float rd_temperature() { unsigned char low, high; //å¼€å¯æ¸©åº¦è½¬æ¢ init_ds18b20(); Write_DS18B20(0xcc); Write_DS18B20(0x44); Delay_OneWire(200); //å¼€å¯æ¸©åº¦è¯»å– init_ds18b20(); Write_DS18B20(0xcc); Write_DS18B20(0xbe); low = Read_DS18B20(); high = Read_DS18B20(); return (float)(high \u0026lt;\u0026lt; 8 | low) * 0.0625; } è¿™é‡Œç»™ä¸€ä¸ªè°ƒç”¨ç¤ºä¾‹\n1 float temp = rd_temperature(); å®Œæ•´ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 /*\t# å•æ€»çº¿ä»£ç ç‰‡æ®µè¯´æ˜ 1. æœ¬æ–‡ä»¶å¤¹ä¸­æä¾›çš„é©±åŠ¨ä»£ç ä¾›å‚èµ›é€‰æ‰‹å®Œæˆç¨‹åºè®¾è®¡å‚è€ƒã€‚ 2. å‚èµ›é€‰æ‰‹å¯ä»¥è‡ªè¡Œç¼–å†™ç›¸å…³ä»£ç æˆ–ä»¥è¯¥ä»£ç ä¸ºåŸºç¡€ï¼Œæ ¹æ®æ‰€é€‰å•ç‰‡æœºç±»å‹ã€è¿è¡Œé€Ÿåº¦å’Œè¯•é¢˜ ä¸­å¯¹å•ç‰‡æœºæ—¶é’Ÿé¢‘ç‡çš„è¦æ±‚ï¼Œè¿›è¡Œä»£ç è°ƒè¯•å’Œä¿®æ”¹ã€‚ */ #include \u0026#34;onewire.h\u0026#34; sbit DQ = P1 ^ 4; // void Delay_OneWire(unsigned int t) { unsigned char i; while (t--) { for (i = 0; i \u0026lt; 12; i++); } } // void Write_DS18B20(unsigned char dat) { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { DQ = 0; DQ = dat \u0026amp; 0x01; Delay_OneWire(5); DQ = 1; dat \u0026gt;\u0026gt;= 1; } Delay_OneWire(5); } // unsigned char Read_DS18B20(void) { unsigned char i; unsigned char dat; for (i = 0; i \u0026lt; 8; i++) { DQ = 0; dat \u0026gt;\u0026gt;= 1; DQ = 1; if (DQ) { dat |= 0x80; } Delay_OneWire(5); } return dat; } // bit init_ds18b20(void) { bit initflag = 0; DQ = 1; Delay_OneWire(12); DQ = 0; Delay_OneWire(80); DQ = 1; Delay_OneWire(10); initflag = DQ; Delay_OneWire(5); return initflag; } float rd_temperature() { unsigned char low, high; init_ds18b20(); Write_DS18B20(0xcc); Write_DS18B20(0x44); Delay_OneWire(200); init_ds18b20(); Write_DS18B20(0xcc); Write_DS18B20(0xbe); low = Read_DS18B20(); high = Read_DS18B20(); return (float)(high \u0026lt;\u0026lt; 8 | low) * 0.0625; } Onewire.h 1 2 #include \u0026lt;STC15F2K60S2.H\u0026gt; float rd_temperature(); IICï¼ˆPCF8591(AD/DA)ä¸AT24C02(EEPROM)ï¼‰æ¨¡ç‰ˆå»ºç«‹ iic.c å®˜æ–¹çš„å‚è€ƒä»£ç  è¿™é‡Œæœ‰å®˜æ–¹æä¾›çš„å‚è€ƒä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šé¢çš„æ—¶åºå¯ä»¥ä¸ç”¨ä¹¦å†™ï¼Œæˆ‘ä»¬ç›´æ¥è¿›è¡ŒADè¯»å–ä¸DAè¾“å‡ºè¿˜æœ‰AT24C02çš„å­˜å‚¨æ“ä½œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 /*\t# I2Cä»£ç ç‰‡æ®µè¯´æ˜ 1. æœ¬æ–‡ä»¶å¤¹ä¸­æä¾›çš„é©±åŠ¨ä»£ç ä¾›å‚èµ›é€‰æ‰‹å®Œæˆç¨‹åºè®¾è®¡å‚è€ƒã€‚ 2. å‚èµ›é€‰æ‰‹å¯ä»¥è‡ªè¡Œç¼–å†™ç›¸å…³ä»£ç æˆ–ä»¥è¯¥ä»£ç ä¸ºåŸºç¡€ï¼Œæ ¹æ®æ‰€é€‰å•ç‰‡æœºç±»å‹ã€è¿è¡Œé€Ÿåº¦å’Œè¯•é¢˜ ä¸­å¯¹å•ç‰‡æœºæ—¶é’Ÿé¢‘ç‡çš„è¦æ±‚ï¼Œè¿›è¡Œä»£ç è°ƒè¯•å’Œä¿®æ”¹ã€‚ */ #define DELAY_TIME 10 // static void I2C_Delay(unsigned char n) { do { _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); } while (n--); } // void I2CStart(void) { sda = 1; scl = 1; I2C_Delay(DELAY_TIME); sda = 0; I2C_Delay(DELAY_TIME); scl = 0; } // void I2CStop(void) { sda = 0; scl = 1; I2C_Delay(DELAY_TIME); sda = 1; I2C_Delay(DELAY_TIME); } // void I2CSendByte(unsigned char byt) { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { scl = 0; I2C_Delay(DELAY_TIME); if (byt \u0026amp; 0x80) { sda = 1; } else { sda = 0; } I2C_Delay(DELAY_TIME); scl = 1; byt \u0026lt;\u0026lt;= 1; I2C_Delay(DELAY_TIME); } scl = 0; } // unsigned char I2CReceiveByte(void) { unsigned char da; unsigned char i; for (i = 0; i \u0026lt; 8; i++) { scl = 1; I2C_Delay(DELAY_TIME); da \u0026lt;\u0026lt;= 1; if (sda) da |= 0x01; scl = 0; I2C_Delay(DELAY_TIME); } return da; } // unsigned char I2CWaitAck(void) { unsigned char ackbit; scl = 1; I2C_Delay(DELAY_TIME); ackbit = sda; scl = 0; I2C_Delay(DELAY_TIME); return ackbit; } // void I2CSendAck(unsigned char ackbit) { scl = 0; sda = ackbit; I2C_Delay(DELAY_TIME); scl = 1; I2C_Delay(DELAY_TIME); scl = 0; sda = 1; I2C_Delay(DELAY_TIME); } æˆ‘ä»¬éœ€è¦è¡¥å……çš„ä»£ç  é¦–å…ˆæ˜¯æˆ‘ä»¬éœ€è¦ç»‘å®šsdaå’Œsclçš„å¼•è„šï¼Œåœ¨åŸç†å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¹¶ä¸”è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†NOPå‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥å¤´æ–‡ä»¶intrins.h\n1 2 3 #include \u0026#34;intrins.h\u0026#34; sbit scl = P2 ^ 0; sbit sda = P2 ^ 1; æˆ‘åœ¨è¿™é‡Œéœ€è¦è¯´æ˜ä¸€ä¸‹IICé€šä¿¡çš„æ–¹å¼ï¼Œä»–æ˜¯ä¸€ä¸ªä¸€ä¸ªå…«ä½çš„æ•°æ®ï¼Œå…¶ä¸­ç¬¬ä¸€ä½æ˜¯æˆ‘ä»¬çš„å‘é€åœ°å€ï¼Œæ°¸è¿œéƒ½æ˜¯1ï¼Œç„¶ååé¢æŒ‚è½½äº†ä¸åŒçš„å¤–è®¾ï¼Œæˆ‘ä»¬çš„è“æ¡¥æ¯çš„æ¿å­æŒ‚äº†ä¸¤ä¸ªå¤–è®¾ï¼Œä¸€ä¸ªæ˜¯PCF8591ï¼Œå¯¹åº”ç€AD/DAçš„åŠŸèƒ½ï¼›å¦ä¸€ä¸ªæ˜¯AT24C02ï¼Œå¯¹åº”ç€EEPROMçš„å­˜å‚¨åŠŸèƒ½ã€‚åœ¨æˆ‘ä»¬æ¿å­ä¸Šå°±é•¿æˆ‘ä»¬ä¸‹é¢è¿™ä¸ªæ ·å­~~ï¼ˆæˆ‘ç”»çš„æœ‰ç‚¹æŠ½è±¡ï¼‰~~ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬è¦å¯¹AT24C02èŠ¯ç‰‡å†™å…¥æ•°æ®çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åœ°å€ä¸ºï¼ˆ1010_0000-\u0026gt;0xa0ï¼‰ï¼Œè¦è¯»å–æ•°æ®çš„åŒ–ï¼Œæˆ‘ä»¬å°±è¦ä½¿ç”¨åœ°å€ä¸ºï¼ˆ1010_0001-\u0026gt;0xa1ï¼‰;è¦å†™å…¥DAè¾“å‡ºçš„æ•°æ®çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åœ°å€ä¸ºï¼ˆ1001_0000-\u0026gt;0x90ï¼‰ï¼Œè¦è¯»å–ADé‡‡æ ·çš„æ•°æ®çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åœ°å€ä¸ºï¼ˆ1001_0001-\u0026gt;0x91ï¼‰\nåœ¨æˆ‘ä»¬ä½¿ç”¨IICè¿›è¡Œé€šä¿¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦éµå¾ªä¸‹é¢çš„è¿è¡Œé€»è¾‘\n1 2 3 4 5 I2CStart(); I2CSendByte(åœ°å€); I2CWaitAck(); I2CSendByte(åŠŸèƒ½); I2CWaitAck(); ADä¸DA ä»ä¸Šé¢è¯´æ˜çš„å†…å®¹çš„æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬è¦å¯¹PCF8591è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹åœ°å€0x90å’Œ0x91è¿›è¡Œæ“ä½œ\næˆ‘ä»¬ç°åœ¨å…ˆè¯´ä¸€ä¸‹ADçš„ä»£ç ï¼Œé€šè¿‡è§‚å¯ŸåŸç†å›¾æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒADæœ‰4ä¸ªé€šé“å¯ä»¥è¿›è¡Œè¯»å–\nå…¶ä¸­AIN0é€šé“æ˜¯æˆ‘ä»¬çš„å¤–éƒ¨æµ‹é‡é€šé“ï¼ˆç”±äºè“æ¡¥æ¯ç°åœ¨è¿˜æ²¡æœ‰æ¶‰åŠåˆ°ä¿¡å·å‘ç”Ÿå™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆæš‚æ—¶ä¸ç”¨ç®¡è¿™ä¸ªé€šé“ï¼‰\nAIN1é€šé“å¾ˆæ˜æ˜¾å°±æ˜¯å…‰æ•ç”µé˜»çš„åˆ†å‹è¯»å–ï¼ˆå…‰ç…§è¶Šå¼ºï¼Œåˆ†å‹è¶Šé«˜ï¼Œé‡‡é›†åˆ°çš„ç»“æœè¶Šå¤§ï¼‰ï¼Œ\nAIN2é€šé“ä¸ºå·®åˆ†è¾“å…¥ï¼ˆæˆ‘ä»¬ä¹Ÿæ˜¯ä¸å¸¸ç”¨åˆ°çš„è¾“å…¥ï¼Œå› ä¸ºæ²¡æœ‰ä¿¡å·å‘ç”Ÿå™¨ï¼‰\nAIN3é€šé“ä¸ºæ»‘åŠ¨å˜é˜»å™¨è¾“å…¥ï¼ˆæˆ‘ä»¬æµ‹é‡æ»‘åŠ¨å˜é˜»å™¨çš„åˆ†å‹ï¼Œè¿™ä¸ªä½ å·¦å³æ—‹é’®çœ‹ä¸€ä¸‹å°±çŸ¥é“å“ªè¾¹å˜å¤§äº†ï¼‰\næˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹PCF8591çš„æ‰‹å†Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¯»å–çš„åœ°å€çš„ä¹¦å†™æ–¹å¼ï¼Œè¿™é‡Œæˆ‘ç»Ÿä¸€ç»™ä¸€ä¸ªè¯´æ˜\nä½æ¬¡ æƒ…å†µè¯´æ˜ æƒ…å†µ ç¬¬ä¸€ä½ å›ºå®šä½ 0 ç¬¬äºŒä½ æ˜¯å¦éœ€è¦å¼€å¯DAè¾“å‡º å¼€å¯DAè¾“å‡ºï¼ˆ1ï¼‰\nä¸å¼€å¯DAè¾“å‡ºï¼ˆ0ï¼‰ ç¬¬ä¸‰å››ä½ é€‰æ‹©è¾“å…¥é€šé“çš„æ¨¡å¼\nå·®åˆ†è¾“å…¥å…·ä½“è¦çœ‹ä¸‹é¢çš„å›¾ é€šé“ä¸ç¼–å·å¯¹åº”è¾“å…¥ï¼ˆå¸¸ç”¨ï¼‰ï¼ˆ00ï¼‰\né€šé“å·®åˆ†è¾“å…¥ï¼ˆ01,10,11ï¼‰ ç¬¬äº”ä½ å›ºå®šä½ 0 ç¬¬å…­ä½ è‡ªåŠ¨é€’å¢æ ‡å¿—\nï¼ˆç”¨äºä¸€ä¸ªä¸€ä¸ªè¯»å–ADè¾“å…¥å£ï¼‰ è‡ªæˆ‘é€’å¢ï¼ˆæ²¡è€ƒè¿‡ï¼Œå› ä¸ºæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯å•ä¸€è¯»å–ï¼‰ï¼ˆ1ï¼‰\nä¸è‡ªæˆ‘é€’å¢ï¼ˆ0ï¼‰ ç¬¬ä¸ƒå…«ä½ ç”¨äºæŒ‡å®šæˆ‘ä»¬è¯»å–çš„é€šé“ é€šé“0ï¼ˆ00ï¼‰ï¼Œåœ¨æˆ‘ä»¬æ­£å¸¸çš„å¯¹åº”è¾“å…¥ä¸‹ä¸ºå¤–éƒ¨ä¿¡å·è¾“å…¥\né€šé“1ï¼ˆ01ï¼‰ï¼Œåœ¨æˆ‘ä»¬æ­£å¸¸çš„å¯¹åº”è¾“å…¥ä¸‹ä¸ºå…‰æ˜ç”µé˜»åˆ†å‹è¾“å…¥\né€šé“2ï¼ˆ10ï¼‰ï¼Œåœ¨æˆ‘ä»¬æ­£å¸¸çš„å¯¹åº”è¾“å…¥ä¸‹ä¸ºå·®åˆ†ä¿¡å·è¾“å…¥\né€šé“3ï¼Œåœ¨æˆ‘ä»¬æ­£å¸¸çš„å¯¹åº”è¾“å…¥ä¸‹ä¸ºæ»‘åŠ¨å˜é˜»å™¨åˆ†å‹è¾“å…¥ï¼ˆ11ï¼‰ æˆ‘ä»¬é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¸¸è€ƒçš„å°±æ˜¯ä¸‹é¢çš„å½¢å¼ï¼Œæ³¨æ„ä¸€ä¸‹é¢˜ç›®ä¸­æ˜¯å¦éœ€æ±‚DAè¾“å‡ºï¼Œå¦‚æœéœ€è¦DAè¾“å‡ºçš„è¯ï¼Œè¿™é‡Œä½¿ç”¨åœ°å€çš„æ—¶å€™å¿…é¡»ä½¿ç”¨å…è®¸DAè¾“å‡ºï¼Œ\néœ€è¦çš„æ•°æ® è¾“å…¥çš„åœ°å€ å¤–éƒ¨ç”µå‹è¾“å…¥ï¼ˆå¼€å¯DAï¼‰ 0100_0000-\u0026gt;0x40 å¤–éƒ¨ç”µå‹è¾“å…¥ï¼ˆä¸å¼€å¯DAï¼‰ 0000_0000-\u0026gt;0x00 å…‰æ•ç”µé˜»åˆ†å‹è¾“å…¥ï¼ˆå¼€å¯DAï¼‰ 0100_0001-\u0026gt;0x41 å…‰æ•ç”µé˜»åˆ†å‹è¾“å…¥ï¼ˆä¸å¼€å¯DAï¼‰ 0000_0001-\u0026gt;0x01 å·®åˆ†ä¿¡å·è¾“å…¥ï¼ˆå¼€å¯DAï¼‰ 0100_0010-\u0026gt;0x42 å·®åˆ†ä¿¡å·è¾“å…¥ï¼ˆä¸å¼€å¯DAï¼‰ 0000_0010-\u0026gt;0x02 æ»‘åŠ¨å˜é˜»å™¨åˆ†å‹è¾“å…¥ï¼ˆå¼€å¯DAï¼‰ 0100_0011-\u0026gt;0x43 æ»‘åŠ¨å˜é˜»å™¨åˆ†å‹è¾“å…¥ï¼ˆä¸å¼€å¯DAï¼‰ 0000_0011-\u0026gt;0x03 æœ‰äº†è¿™æ ·ä¸€ä¸ªåŸºç¡€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç€æ‰‹ç¼–å†™æˆ‘ä»¬çš„ADä»£ç äº†\næˆ‘ä»¬åªéœ€è¦æŒ‡å®šä¸€ä¸‹æˆ‘ä»¬éœ€è¦è¯»å–çš„é€šé“çš„åœ°å€å°±è¡Œ\n1 unsigned char Ad_Read(unsigned char addr) è¿™é‡Œç»™ä¸€ä¸ªè°ƒç”¨ç¤ºä¾‹ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ åŒæ—¶è¯»å–å…‰æ•ç”µé˜»å’Œæ»‘åŠ¨å˜é˜»å™¨çš„å€¼ï¼Œä»–ä»¬ä¼šåœ°å€äº¤æ¢ï¼Œä½ ä»¬å¯ä»¥è‡ªå·±å»è¯•è¯•ã€‚\n1 unsigned char temp = Ad_Read(0x01);//è¯»å–å…‰æ•ç”µé˜»ç»“æœ é¦–å…ˆæˆ‘ä»¬éœ€è¦é€‰ä¸­æˆ‘ä»¬çš„PCFèŠ¯ç‰‡å¹¶ä¸”å†™å…¥æˆ‘ä»¬éœ€è¦è¯»å–çš„åœ°å€,è¿™é‡Œéœ€è¦æ³¨æ„çš„å°±åªæœ‰æ¯æ¬¡å‘é€Byteåæˆ‘ä»¬éœ€è¦Waitä¸€ä¸‹\n1 2 3 4 5 6 // é€‰æ‹©èŠ¯ç‰‡ä¸ºPCF I2CStart(); I2CSendByte(0x90); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); ç„¶åé‡æ–°å¼€å¯ä¸€ä¸‹é€šè¯ï¼ˆå› ä¸ºæˆ‘ä»¬ä¸Šé¢æ˜¯è¿›è¡Œå†™æ“ä½œï¼Œç°åœ¨è¦è¿›è¡Œè¯»æ“ä½œï¼‰ï¼Œè¯»å–åæˆ‘ä»¬éœ€è¦å‘é€ä¸€ä¸ªAckä¸º1ï¼Œè¡¨æ˜æˆ‘ä»¬è¿™è¾¹æ¥æ”¶æ•°æ®å®Œæˆï¼Œåç»­ä¸ç”¨æ¥å—äº†ï¼Œç»“æŸåå°±å¯ä»¥å…³é—­å¯¹è¯Stopäº†\n1 2 3 4 5 6 I2CStart(); I2CSendByte(0x91); I2CWaitAck(); temp = I2CReceiveByte(); I2CSendAck(1); I2CStop(); ADå®Œæ•´ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 unsigned char Ad_Read(unsigned char addr) { unsigned char temp; // é€‰æ‹©èŠ¯ç‰‡ä¸ºPCF I2CStart(); I2CSendByte(0x90); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); I2CStart(); I2CSendByte(0x91); I2CWaitAck(); temp = I2CReceiveByte(); I2CSendAck(1); I2CStop(); return temp; } è¯´å®ŒADæˆ‘ä»¬å°±è¦è¯´åˆ°DAäº†\nå’ŒADä¸€æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦ä¼ å…¥æˆ‘ä»¬éœ€è¦å†™å…¥çš„æ•°æ®å°±è¡Œï¼Œä½†æ˜¯è¦æ³¨æ„ä¸€ä¸‹æˆ‘ä»¬çš„æ•°æ®ä¸ºæ•°å­—ç”µå‹ï¼Œå³0-255ï¼Œæˆ‘ä»¬è¾“å‡ºåçš„ç”µå‹æ˜¯æ¨¡æ‹Ÿç”µå‹ï¼Œå³0-5Vï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯ä¸€ä¸€æ˜ å°„è¿‡å»çš„\n1 void Da_Write(unsigned char dat) ä¸¾ä¸ªğŸŒ°ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦è¾“å‡ºç”µå‹ä¸º2V,é‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥\n1 Da_Write(2*51); å¦‚æœæƒ³è¦è¾“å‡ºçš„ç”µå‹ä¸º2.5Vï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥ï¼Œè¿™é‡Œä¸ç”¨å…³å¿ƒä»–ä¼šå‡ºç°ä¸åŒ¹é…çš„æƒ…å†µï¼ŒCè¯­è¨€åº•å±‚ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºunsigned charç±»å‹çš„,è¿™ç±»æœ‰å•Šæ³¨æ„\n1 Da_Write(2.5*51); é¦–å…ˆæˆ‘ä»¬éœ€è¦é€‰ä¸­æˆ‘ä»¬çš„PCFèŠ¯ç‰‡å¹¶ä¸”ç»™ä»–æˆ‘ä»¬çš„åœ°å€ä¿¡æ¯ï¼ˆå‰é¢æåˆ°è¿‡å¦‚æœè¦å¼€å¯DAè¾“å‡ºï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å†™å…¥çš„åœ°å€ï¼‰,è¿™é‡Œéœ€è¦æ³¨æ„çš„å°±åªæœ‰æ¯æ¬¡å‘é€Byteåæˆ‘ä»¬éœ€è¦Waitä¸€ä¸‹ï¼Œè¿™é‡Œçš„0x41å¯ä»¥æ›´æ¢ä¸º0x40-0x43çš„ä»»ä½•ä¸€ä¸ªï¼Œä½†æ˜¯æœ€å¥½å’Œé¢˜ç›®ä¸­è¦æ±‚ADéœ€è¦è¯»å–çš„é€šé“ä¸€è‡´ï¼ˆè¿™é‡Œä¹Ÿè¦æ³¨æ„åœ¨ä½ è¯»å–ADçš„æ—¶å€™åŠ ä¸Š0x4ï¼‰\n1 2 3 4 5 6 7 8 9 10 void Da_Write(unsigned char dat) { // é€‰æ‹©èŠ¯ç‰‡ä¸ºPCF I2CStart(); I2CSendByte(0x90); I2CWaitAck(); I2CSendByte(0x41); I2CWaitAck(); I2CSendByte(dat); I2CWaitAck(); } ADä¸\nEEPROM ä»ä¸Šé¢è¯´æ˜çš„å†…å®¹çš„æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬è¦å¯¹AT24C02è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹åœ°å€0xa0å’Œ0xa1è¿›è¡Œæ“ä½œ\næœ¬è´¨ä¸Šæˆ‘ä»¬çš„EEPROMå†™å…¥ä¸è¯»å–å’ŒAD/DAæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬é€šå¸¸å†™å…¥/è¯»å–çš„ä¸æ­¢ä¸€ä¸ªæ•°æ®ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¸€ä¸ªæ•°ç»„å†™è¿›å»å’Œè¯»å–ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦æ³¨æ„è¿™ä¸ªç‚¹ï¼Œæˆ‘ä»¬çš„æ“ä½œå¦‚ä¸‹ï¼Œä¼ é€’çš„æ•°æ®éƒ½æ˜¯æ•°ç»„çš„é¦–åœ°å€ï¼ˆå¦‚æœå­˜å•ä¸ªæ•°æ®åªéœ€è¦ä½¿ç”¨\u0026amp;nameå°±è¡Œï¼‰ï¼Œä¼ å…¥å‚æ•°ä¸ºéœ€è¦å†™å…¥/è¯»å–æ•°ç»„é¦–åœ°å€åç§°ï¼‰ï¼‰strï¼Œéœ€è¦å†™å…¥/è¯»å–çš„æ•°ç»„åœ°å€addrï¼Œæ•°ç»„çš„å¤§å°num\n1 2 void EEPROM_Write(unsigned char *str, unsigned char addr, unsigned char num) void EEPROM_Read(unsigned char *str, unsigned char addr, unsigned char num) è¿™é‡Œç»™ä¸€ä¸ªè°ƒç”¨çš„ç¤ºä¾‹ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹å¦‚æœå†™å…¥ä¸ºunsigned intï¼Œå¯ä»¥ä¸ç”¨åˆ†ä¸ºé«˜ä½ä½å­˜å‚¨ï¼Œä½†æ˜¯éœ€è¦åˆ†ä¸ºé«˜ä½ä½è¯»å–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 unsigned char arr_input[5]={1,2,3,4,5}; unsigned char arr_output[5]; EEPROM_Write(arr_input,0,5); EEPROM_Read(arr_output,0,5); unsigned char input = 5; unsigned char output; EEPROM_Write(\u0026amp;input,0,1); EEPROM_Read(\u0026amp;output,0,1); unsigned int input = 5; unsigned int output; unsigned char high,low; EEPROM_Write(\u0026amp;input,0,2); EEPROM_Read(\u0026amp;high,0,1); EEPROM_Read(\u0026amp;low,1,1); output = high\u0026lt;\u0026lt;4 | low; ç°åœ¨æˆ‘æ¥è¯´ä¸€ä¸‹å®ç°ç»†èŠ‚\nå…ˆè¯´æ˜ä¸€ä¸‹EEPROM_Readå‡½æ•°ï¼Œå’Œä¸Šæ–‡çš„ADè¯»å–ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé€‰ä¸­AT24C02ï¼Œå¹¶ä¸”åŠŸèƒ½ä¸ºå†™ï¼Œç„¶åè¿›è¡Œä½ç½®çš„ä¼ è¾“ï¼Œç¡®è®¤æˆ‘ä»¬éœ€è¦è¯»å–çš„åœ°å€\n1 2 3 4 5 I2CStart(); I2CSendByte(0xa0); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); åœ¨æˆ‘ä»¬è¯»å–çš„æ—¶å€™ï¼Œå’Œä¸Šæ–‡ADä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°å¼€å¯ä¸€ä¸ªå¯¹è¯è¿›è¡Œè¯»å–\n1 2 3 I2CStart(); I2CSendByte(0xa1); I2CWaitAck(); ä½†æ˜¯åœ¨æˆ‘ä»¬è¯»å–çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°ç»„è¿›è¡Œçš„æ•°æ®è¯»å–ï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬è¯»å–çš„æ—¶å€™å¯¹æŒ‡é’ˆè¿›è¡Œ++æ“ä½œï¼Œå½“æˆ‘ä»¬è¿˜æ²¡æœ‰è¯»å®Œæ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘é€Ackä¸º0ï¼Œä»£è¡¨æˆ‘ä»¬éœ€è¦ç»§ç»­è¯»å–ï¼Œå½“æˆ‘ä»¬è¯»å–æ•°æ®ç»“æŸåï¼Œæˆ‘ä»¬å‘é€Ackä¸º1ï¼Œè¡¨ç¤ºè¯»å–ç»“æŸï¼Œæœ€åä¹Ÿåˆ«å¿˜è®°éœ€è¦è¿›è¡ŒStopåœæ­¢äº¤æµã€‚\n1 2 3 4 5 6 7 8 9 10 11 I2CStart(); I2CSendByte(0xa1); I2CWaitAck(); while (num--) { *str++ = I2CReceiveByte(); if (num) I2CSendAck(0); else I2CSendAck(1); } I2CStop(); åœ¨è¿™é‡Œè¯´æ˜ä¸€ä¸‹*str++ä»£è¡¨çš„å«ä¹‰ï¼Œè¿™æ˜¯cçš„ä¸€ä¸ªå†™æ³•ï¼Œç­‰ä»·äºä¸‹é¢çš„ä»£ç \n1 2 3 4 5 6 7 8 9 unsigned char arr[5]; unsigned char i = 0; unsigned char num = 5; while(num--) { arr[i] = I2CReceiveByte(); i++; ----- } å®Œæ•´çš„ä»£ç EEPROM_READå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 void EEPROM_Read(unsigned char *str, unsigned char addr, unsigned char num) { I2CStart(); I2CSendByte(0xa0); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); I2CStart(); I2CSendByte(0xa1); I2CWaitAck(); while (num--) { *str++ = I2CReceiveByte(); if (num) I2CSendAck(0); else I2CSendAck(1); } I2CStop(); } æˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢çœ‹åˆ°ï¼ŒADå’ŒEEPROM_READå¯ä»¥è¿›è¡Œç±»æ¯”ï¼›åŒç†ï¼Œæˆ‘ä»¬çš„DAå’ŒEEPROM_Writeä¹Ÿå¯ä»¥è¿›è¡Œç±»æ¯”ï¼Œä½†æ˜¯EEPROM_Writeæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼Œæˆ‘ä¼šåœ¨ä¸‹é¢è¿›è¡Œè¯´æ˜\næˆ‘ä»¬ç¬¬ä¸€æ­¥è¿˜æ˜¯é€‰æ‹©æˆ‘ä»¬çš„èŠ¯ç‰‡ï¼Œé€‰æ‹©æˆ‘ä»¬éœ€è¦å†™å…¥çš„åœ°å€\n1 2 3 4 5 I2CStart(); I2CSendByte(0xa0); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); ç¬¬äºŒæ­¥å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå¾ªç¯è¿›è¡Œå†™å…¥ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬æ¯å†™å…¥ä¸€ä¸ªæ•°æ®ï¼Œéƒ½éœ€è¦I2C_Delayä¸€ä¸‹ï¼Œæ³¨æ„ä¸æ˜¯Delayï¼Œè€Œæ˜¯I2C_Delayï¼Œç»è¿‡æˆ‘ä»¬æµ‹è¯•ï¼Œå½“è¿™ä¸ªå€¼ä¸º200 çš„æ—¶å€™æ•ˆæœæ˜¯å¯ä»¥çš„ï¼Œå¹¶ä¸”è¿™é‡Œæœ‰ä¸ªæœ€æœ€é‡è¦çš„ç‚¹ï¼Œåœ¨æˆ‘ä»¬Stopç»“æŸåï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œ4ä¸ª255æ—¶é—´çš„I2C_Delay~~ï¼ˆå…¶å®æˆ‘åœ¨ç¾¤é‡Œé¢è¯´è¿‡ï¼Œä½†ä½ ä»¬ä¸€ç›´è§‰å¾—æˆ‘åœ¨è®²ä¹å­ï¼‰~~\n1 2 3 4 5 6 7 8 9 10 while (num--) { I2CSendByte(*str++); I2CWaitAck(); I2C_Delay(200); } I2CStop(); I2C_Delay(255); I2C_Delay(255); I2C_Delay(255); I2C_Delay(255); å®Œæ•´çš„ä»£ç EEPROM_Writeå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 void EEPROM_Write(unsigned char *str, unsigned char addr, unsigned char num) { I2CStart(); I2CSendByte(0xa0); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); while (num--) { I2CSendByte(*str++); I2CWaitAck(); I2C_Delay(200); } I2CStop(); I2C_Delay(255); I2C_Delay(255); I2C_Delay(255); I2C_Delay(255); } å®Œæ•´ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 /*\t# I2Cä»£ç ç‰‡æ®µè¯´æ˜ 1. æœ¬æ–‡ä»¶å¤¹ä¸­æä¾›çš„é©±åŠ¨ä»£ç ä¾›å‚èµ›é€‰æ‰‹å®Œæˆç¨‹åºè®¾è®¡å‚è€ƒã€‚ 2. å‚èµ›é€‰æ‰‹å¯ä»¥è‡ªè¡Œç¼–å†™ç›¸å…³ä»£ç æˆ–ä»¥è¯¥ä»£ç ä¸ºåŸºç¡€ï¼Œæ ¹æ®æ‰€é€‰å•ç‰‡æœºç±»å‹ã€è¿è¡Œé€Ÿåº¦å’Œè¯•é¢˜ ä¸­å¯¹å•ç‰‡æœºæ—¶é’Ÿé¢‘ç‡çš„è¦æ±‚ï¼Œè¿›è¡Œä»£ç è°ƒè¯•å’Œä¿®æ”¹ã€‚ */ #include \u0026#34;iic.h\u0026#34; #include \u0026#34;intrins.h\u0026#34; #define DELAY_TIME 5 sbit scl = P2 ^ 0; sbit sda = P2 ^ 1; // static void I2C_Delay(unsigned char n) { do { _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); _nop_(); } while (n--); } // void I2CStart(void) { sda = 1; scl = 1; I2C_Delay(DELAY_TIME); sda = 0; I2C_Delay(DELAY_TIME); scl = 0; } // void I2CStop(void) { sda = 0; scl = 1; I2C_Delay(DELAY_TIME); sda = 1; I2C_Delay(DELAY_TIME); } // void I2CSendByte(unsigned char byt) { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { scl = 0; I2C_Delay(DELAY_TIME); if (byt \u0026amp; 0x80) { sda = 1; } else { sda = 0; } I2C_Delay(DELAY_TIME); scl = 1; byt \u0026lt;\u0026lt;= 1; I2C_Delay(DELAY_TIME); } scl = 0; } // unsigned char I2CReceiveByte(void) { unsigned char da; unsigned char i; for (i = 0; i \u0026lt; 8; i++) { scl = 1; I2C_Delay(DELAY_TIME); da \u0026lt;\u0026lt;= 1; if (sda) da |= 0x01; scl = 0; I2C_Delay(DELAY_TIME); } return da; } // unsigned char I2CWaitAck(void) { unsigned char ackbit; scl = 1; I2C_Delay(DELAY_TIME); ackbit = sda; scl = 0; I2C_Delay(DELAY_TIME); return ackbit; } // void I2CSendAck(unsigned char ackbit) { scl = 0; sda = ackbit; I2C_Delay(DELAY_TIME); scl = 1; I2C_Delay(DELAY_TIME); scl = 0; sda = 1; I2C_Delay(DELAY_TIME); } unsigned char Ad_Read(unsigned char addr) { unsigned char temp; // é€‰æ‹©èŠ¯ç‰‡ä¸ºPCF I2CStart(); I2CSendByte(0x90); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); I2CStart(); I2CSendByte(0x91); I2CWaitAck(); temp = I2CReceiveByte(); I2CSendAck(1); I2CStop(); return temp; } // æ•°å­—ç”µå‹255-\u0026gt;5V void Da_Write(unsigned char dat) { // é€‰æ‹©èŠ¯ç‰‡ä¸ºPCF I2CStart(); I2CSendByte(0x90); I2CWaitAck(); I2CSendByte(0x41); I2CWaitAck(); I2CSendByte(dat); I2CWaitAck(); } void EEPROM_Write(unsigned char *str, unsigned char addr, unsigned char num) { I2CStart(); I2CSendByte(0xa0); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); while (num--) { I2CSendByte(*str++); I2CWaitAck(); I2C_Delay(200); } I2CStop(); I2C_Delay(255); I2C_Delay(255); I2C_Delay(255); I2C_Delay(255); } void EEPROM_Read(unsigned char *str, unsigned char addr, unsigned char num) { I2CStart(); I2CSendByte(0xa0); I2CWaitAck(); I2CSendByte(addr); I2CWaitAck(); I2CStart(); I2CSendByte(0xa1); I2CWaitAck(); while (num--) { *str++ = I2CReceiveByte(); if (num) I2CSendAck(0); else I2CSendAck(1); } I2CStop(); } iic.h 1 2 3 4 5 #include \u0026lt;STC15F2K60S2.H\u0026gt; unsigned char Ad_Read(unsigned char addr); void Da_Write(unsigned char dat); void EEPROM_Write(unsigned char *str, unsigned char addr, unsigned char num); void EEPROM_Read(unsigned char *str, unsigned char addr, unsigned char num); Uartä¸²å£æ¨¡ç‰ˆå»ºç«‹ uart.c åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œä¸²å£å®˜æ–¹æ˜¯æ²¡æœ‰ç»™åº•å±‚çš„ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æ‰‹æ“ï¼Œåœ¨è¿™é‡Œæˆ‘ç»™çš„ä»£ç ä¸ºé‡å®šå‘ä»£ç ã€‚\né¦–å…ˆæ˜¯ä½¿ç”¨ispç”Ÿæˆä¸€ä¸ªç”¨å®šæ—¶å™¨2è®¡æ—¶çš„ä¸²å£1çš„ä»£ç ï¼Œæ³¢ç‰¹ç‡ä¸º9600ï¼ˆæ¯”èµ›çš„æ—¶å€™å¯èƒ½ä¸æ˜¯9600ï¼Œè¦æ ¹æ®é¢˜ç›®æ¥çœ‹ï¼‰ï¼Œå®šæ—¶å™¨æ—¶é’Ÿé€‰ç”¨12Tï¼Œæ•°æ®ä½ä¸º8ä½\næˆ‘ä»¬ç›´æ¥æŠŠä»–å¤åˆ¶åˆ°æˆ‘ä»¬ä»£ç é‡Œé¢å°±è¡Œï¼Œæœ€ååˆ«å¿˜è®°åŠ ä¸€ä¸ªEA=1æ¥å¼€å¯æ€»ä¸­æ–­ï¼Œè¿˜æœ‰äº›ispç‰ˆæœ¬å¯èƒ½æ¯”è¾ƒè€ï¼Œæ²¡æœ‰ä½¿èƒ½ä¸­æ–­çš„é€‰é¡¹ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±åŠ ä¸ŠES=1\n1 2 3 4 5 6 7 8 9 10 11 void Uart1_Init(void) // 9600bps@12.000MHz { SCON = 0x50; // 8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡ AUXR |= 0x01; // ä¸²å£1é€‰æ‹©å®šæ—¶å™¨2ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨ AUXR |= 0x04; // å®šæ—¶å™¨æ—¶é’Ÿ1Tæ¨¡å¼ T2L = 0xC7; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ T2H = 0xFE; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ AUXR |= 0x10; // å®šæ—¶å™¨2å¼€å§‹è®¡æ—¶ ES = 1; // ä½¿èƒ½ä¸²å£1ä¸­æ–­ EA = 1; } æˆ‘ä»¬è¿™é‡Œä¸éœ€è¦å®ç°å¤æ‚çš„å‡½æ•°ï¼Œåªéœ€è¦å®ç°ä¸€ä¸ªé‡å®šå‘å°±è¡Œï¼Œä½¿ç”¨printfç›´æ¥å°†æ•°æ®å‘é€åˆ°ä¸²å£å°±è¡Œï¼Œæˆ‘ç°åœ¨è¯´ä¸€ä¸‹æ­¥éª¤\næˆ‘ä»¬é€šè¿‡æŸ¥çœ‹c51é‡Œé¢ï¼ˆæ³¨æ„æ˜¯c51ï¼Œä¸æ˜¯æ ‡å‡†çš„cè¯­è¨€å‡½æ•°åº“ï¼Œç›´æ¥åœ¨keilé‡Œé¢å³é”®æ‰“å¼€ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹æ–¹æœ‰ä¸€ä¸ªputcharçš„ä¸€ä¸ªexternçš„å‡½æ•°å®šä¹‰ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦é‡è½½çš„å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬printfæœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨putcharçš„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 /*-------------------------------------------------------------------------- STDIO.H Prototypes for standard I/O functions. Copyright (c) 1988-2002 Keil Elektronik GmbH and Keil Software, Inc. All rights reserved. --------------------------------------------------------------------------*/ #ifndef __STDIO_H__ #define __STDIO_H__ #ifndef EOF #define EOF -1 #endif #ifndef NULL #define NULL ((void *) 0) #endif #ifndef _SIZE_T #define _SIZE_T typedef unsigned int size_t; #endif #pragma SAVE #pragma REGPARMS extern char _getkey (void); extern char getchar (void); extern char ungetchar (char); extern char putchar (char); extern int printf (const char *, ...); extern int sprintf (char *, const char *, ...); extern int vprintf (const char *, char *); extern int vsprintf (char *, const char *, char *); extern char *gets (char *, int n); extern int scanf (const char *, ...); extern int sscanf (char *, const char *, ...); extern int puts (const char *); #pragma RESTORE #endif æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸²å£åœ¨å‘é€çš„æ—¶å€™ï¼Œä¼šå°†æ•°æ®æ”¾è¿›ç¼“å†²åŒºSBUFï¼ˆå¦‚æœä½ ç”¨ä¸²å£2é‚£å°±æ˜¯S2BUFï¼Œä½†æ˜¯è¿™é‡Œæ²¡æ¶‰åŠåˆ°ï¼Œå°±ä¸ç”¨ç®¡äº†ï¼‰ï¼Œå½“æˆ‘ä»¬æ­£åœ¨å‘é€çš„æ—¶å€™TIæ ‡å¿—ä½ä¸º0ï¼Œå½“æˆ‘ä»¬å‘é€å®Œæˆåï¼Œä»–å°±ä¼šè¢«ç½®ä¸º0ï¼Œç„¶åæˆ‘ä»¬éœ€è¦å°†chè¿”å›ï¼ˆè¿™ä¸ªæ˜¯å‡½æ•°æœ¬èº«å°±éœ€è¦è¿”å›çš„charï¼‰\n1 2 3 4 5 6 extern char putchar(char ch) { SBUF = ch; while (TI == 0); TI = 0; return ch; } uart.h 1 2 3 4 #include \u0026lt;STC15F2K60S2.H\u0026gt; #include \u0026#34;stdio.h\u0026#34; void Uart1_Init(void); Ulè¶…å£°æ³¢æ¨¡ç‰ˆå»ºç«‹ ul.c åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œè¶…å£°æ³¢å®˜æ–¹æ˜¯æ²¡æœ‰ç»™åº•å±‚çš„ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æ‰‹æ“ã€‚æˆ‘ä»¬é€šè¿‡æŸ¥è¯¢åŸç†å›¾å¯ä»¥çœ‹åˆ°ï¼Œè¶…å£°æ³¢çš„Tä¸ºP10ï¼ŒRä¸ºP11ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸‹\n1 2 sbit Tx = P1 ^ 0; sbit Rx = P1 ^ 1; ç°åœ¨æˆ‘ä»¬æ¥è¿›è¡Œé€»è¾‘çš„ä¹¦å†™ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“è¶…å£°æ³¢æµ‹è·çš„åŸç†ï¼Œæˆ‘å‘é€æ•°æ®åï¼Œç­‰å¾…æ¥æ”¶æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘é€šè¿‡è®¡ç®—å‘é€å’Œæ¥æ”¶ä¸­çš„é—´éš”æ—¶é—´ï¼Œå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„è·ç¦»ï¼Œè¿™é‡Œç”¨æ•°å­¦å…¬å¼å¯ä»¥è¿›è¡Œè®¡ç®—ï¼Œä¸€èˆ¬æ¥è¯´å£°é€Ÿéƒ½æ˜¯340m/sï¼ˆä¹Ÿä¸æ’é™¤é¢˜ç›®é‡Œé¢å’Œä½ è¯´è¦å¯¹å…¶è¿›è¡Œå˜æ¢å•¥çš„ã€æ¯”å¦‚ç¬¬åå››å±Šå›½èµ›ã€‘ï¼Œè¿™é‡Œå°±æŒ‰ç…§å£°é€Ÿä¸º340m/sæ¥è¿›è¡Œè¯´æ˜ï¼‰\n$$ d = {{vt} \\over 2} = {{340m/st} \\over 2} = 170m/st = 1.7*{10^4}cm/s*t $$\næˆ‘ä»¬è¿™é‡Œæœ‰ä¸€ä¸ªå•ä½æ¢ç®—éœ€è¦è¿›è¡Œæ³¨æ„ï¼Œtçš„å•ä½ä¸ºusï¼Œä¹Ÿå°±æ˜¯\ntitle: Chinese Test description: è¿™æ˜¯ä¸€ä¸ªå‰¯æ ‡é¢˜ date: 2020-09-09 slug: test-chinese image: helena-hertz-wWZzXlDpMog-unsplash.jpg categories: - Test - æµ‹è¯•\n$$ {10^{ - 6}}s $$\n$$ d = 1.7*{10^4}*{10^{ - 6}}t = 0.017t $$\nå›¾æ¥è‡ªå¾®ä¿¡ç¾¤å‹chmod-wrxç»˜åˆ¶ï¼ˆæˆ‘ç»˜å›¾å¤ªğŸŒ¶ï¸ğŸ”äº†ï¼‰\næ ¹æ®æˆ‘ä»¬ä¸Šæ–¹çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬é¦–å…ˆéœ€è¦è¿›è¡Œå‘é€ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå‘é€8ä¸ª40kHzçš„æ–¹æ³¢è¿›è¡Œæµ‹é‡ï¼Œé‚£ä¹ˆå‘¨æœŸå°±æ˜¯\n$$ {1 \\over {40k}} = 25 \\cdot {10^{ - 6}}s = 25us $$\nï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦$12us$å°†å‘é€çš„ç”µå¹³è¿›è¡Œåè½¬\nä»£ç å¦‚ä¸‹ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ispç”Ÿæˆä¸€ä¸ª12usçš„å»¶æ—¶å‡½æ•°,è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¦æ­£ç¡®ä½¿ç”¨ç³»ç»Ÿé¢‘ç‡ä¸º12MHzï¼›å¦‚æœè¿™é‡Œæµ‹é‡ç»“æœæœ‰é—®é¢˜ï¼Œå¯ä»¥å°è¯•å°†33ä¿®æ”¹ä¸º38æˆ–è€…å…¶ä»–çš„æ•°æ®ï¼Œå› ä¸ºè½¯ä»¶å»¶æ—¶ä¸å‡†ã€‚\n1 2 3 4 5 6 7 8 9 void Delay12us(void)\t//@12.000MHz { unsigned char data i; _nop_(); _nop_(); i = 33;//å¯ä»¥ä¿®æ”¹ä¸ºå…¶ä»–æ•°æ®ï¼Œæ¯”å¦‚38 while (--i); } ç„¶åå°±æ˜¯æˆ‘ä»¬çš„è¶…å£°æ³¢å‘é€å‡½æ•°ï¼Œå‘é€8ä¸ª4kHzçš„æ–¹æ³¢\n1 2 3 4 5 6 7 8 9 void Ut_Wave_Init() { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { Tx = 1; Delay12us(); Tx = 0; Delay12us(); } } æœ€åæ˜¯æˆ‘ä»¬æœ€é‡è¦çš„æ•°æ®æ¥æ”¶ä¸è½¬æ¢å‡½æ•°çš„ä¹¦å†™ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„pcaå®šæ—¶å™¨ï¼Œå¯ä»¥èŠ‚çœå®šæ—¶å™¨æ¥è¿›è¡Œå…¶ä»–çš„æ“ä½œï¼ˆå› ä¸ºne555å¼ºåˆ¶å ç”¨å®šæ—¶å™¨0ï¼Œä¸²å£è€ƒåˆ°å°±ä¼šå ç”¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¿˜æœ‰ä¸€ä¸ªå®šæ—¶å™¨éœ€è¦ç”¨æ¥è¿›è¡Œå‡½æ•°è½®è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¿…é¡»ç”¨å…¶ä»–çš„å®šæ—¶å™¨è¿›è¡Œè¶…å£°æ³¢çš„æ“ä½œï¼‰,å…¶å®PCAæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ‰€ä»¥ä»–ä¹Ÿå­˜åœ¨ä¸€äº›å®šæ—¶å™¨çš„å‚æ•°ï¼Œæ¯”å¦‚TLx-\u0026gt;CL;THx-\u0026gt;CH;TMOD-\u0026gt;CMOD;TRx-\u0026gt;CR;TFx-\u0026gt;CF\næˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¹å®šæ—¶å™¨çš„CHå’ŒCLæ¸…é›¶ï¼Œä¸ºäº†æˆ‘ä»¬è®¡æ•°åšå‡†å¤‡ï¼›ç„¶åå°†CMODé…ç½®ä¸º0x00ï¼Œåå…­ä½ä¸é‡è½½å®šæ—¶å™¨ã€‚\n1 2 CH = CL = 0; CMOD = 0x00; åœ¨æˆ‘ä»¬å‘é€è¶…å£°æ³¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†æ€»ä¸­æ–­å…³é—­ï¼Œåœ¨æˆ‘ä»¬å‘é€å®Œæ¯•åå°±å…³æ‰ï¼Œåœ¨æˆ‘ä»¬å‘é€å®Œæˆåï¼Œå°±æ‰“å¼€CRå¼€å§‹è®¡æ—¶ï¼Œç­‰å¾…æˆ‘ä»¬æ”¶åˆ°å›åº”ï¼ˆæ”¶åˆ°å›åº”åRxä¸º0ï¼‰æˆ–è€…è®¡æ•°æº¢å‡ºï¼ˆæº¢å‡ºåCFä¸º1ï¼‰ï¼Œæˆ‘ä»¬å°±å…³é—­CRå¼€å§‹è¯»å–æ•°æ®\n1 2 3 4 5 6 7 EA = 0; Ut_Wave_Init(); EA = 1; CR = 1; while (Rx \u0026amp;\u0026amp; !CF); CR = 0; å¦‚æœæˆ‘ä»¬æ˜¯å› ä¸ºæ”¶åˆ°å›åº”è€Œç»“æŸï¼ˆé‚£ä¹ˆå°±ä»£è¡¨æˆ‘ä»¬æµ‹é‡åˆ°äº†æ•°æ®ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¿›è¡Œæ—¶é—´è¯»å–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œä½ ä»¬å¯èƒ½ä¼šå¥½å¥‡ä¸ºä»€ä¹ˆ+3ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬å®é™…æµ‹é‡å‘ç°ï¼Œ+3ååœ¨è¿œç¨‹æ•°æ®ï¼ˆæµ‹é‡ç»“æœ\u0026gt;10çš„æ—¶å€™ï¼‰è¯¯å·®ä¼šæ¯”è¾ƒå°ï¼Œè€Œè¿‘ç¨‹æ•°æ®ï¼ˆæµ‹é‡æ•°æ®\u0026lt;10ï¼‰æ»¡è¶³è¯¯å·®èŒƒå›´ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¯èƒ½æµ‹é‡å¾—åˆ°0è¿™ä¸ªæ•°æ®ï¼ˆé¢˜ç›®ä¸­ä¸€èˆ¬éƒ½ä¸ä¼šæµ‹åˆ°0ï¼‰ï¼ˆæ‰€ä»¥æˆ‘ä»¬æ‰æŠŠä»–è§†ä¸ºæµ‹é‡é”™è¯¯çš„è¿”å›ç»“æœï¼‰\n1 2 time = CH \u0026lt;\u0026lt; 8 | CL; return (0.017 * time + 3); å¦‚æœæˆ‘ä»¬æ˜¯å› ä¸ºè®¡æ•°æº¢å‡ºï¼ˆæ²¡æœ‰æ”¶åˆ°è¿”å›çš„ä¿¡å·ï¼Œä»£è¡¨æµ‹é‡é”™è¯¯ï¼‰ï¼Œæˆ‘ä»¬å°±ç›´æ¥è¿”å›ä¸º0ï¼Œè¡¨ç¤ºé”™è¯¯ç»“æœ\n1 return 0; è½¬æ¢çš„å®Œæ•´ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 unsigned char Ut_Wave_Data() { unsigned int time; CH = CL = 0; CMOD = 0x00; EA = 0; Ut_Wave_Init(); EA = 1; CR = 1; while (Rx \u0026amp;\u0026amp; !CF); CR = 0; if (!CF) { // us -\u0026gt; s 10^(-6) // m -\u0026gt; cm 10^2 // 10^(-4) // L = V*T/2=340*time/2=170*10^(-4)*time=0.017*time time = CH \u0026lt;\u0026lt; 8 | CL; return (0.017 * time + 3); } else { CF = 0; return 0; } } å®Œæ•´ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 #include \u0026#34;ul.h\u0026#34; #include \u0026#34;intrins.h\u0026#34; sbit Tx = P1 ^ 0; sbit Rx = P1 ^ 1; void Delay12us(void) //@12.000MHz { unsigned char data i; _nop_(); _nop_(); i = 33; // 38 while (--i); } void Ut_Wave_Init() { unsigned char i; for (i = 0; i \u0026lt; 8; i++) { Tx = 1; Delay12us(); Tx = 0; Delay12us(); } } unsigned char Ut_Wave_Data() { unsigned int time; CH = CL = 0; CMOD = 0x00; EA = 0; Ut_Wave_Init(); EA = 1; CR = 1; while (Rx \u0026amp;\u0026amp; !CF); CR = 0; if (!CF) { // us -\u0026gt; s 10^(-6) // m -\u0026gt; cm 10^2 // 10^(-4) // L = V*T/2=340*time/2=170*10^(-4)*time=0.017*time time = CH \u0026lt;\u0026lt; 8 | CL; return (0.017 * time + 3); } else { CF = 0; return 0; } } ul.h 1 2 #include \u0026lt;STC15F2K60S2.H\u0026gt; unsigned char Ut_Wave_Data(); initåˆå§‹åŒ–æ¨¡ç‰ˆå»ºç«‹ init.c æˆ‘ä»¬åœ¨å¯åŠ¨å¼€å‘æ¿çš„æ—¶å€™æœ€å¥½å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼Œå…³é—­èœ‚é¸£å™¨å’Œç»§ç”µå™¨ï¼ŒMOTORå’Œå…¨éƒ¨LEDç¯ï¼Œé¿å…ä¸Šç”µæƒ…å†µæœ‰è¯¯\n1 2 3 4 5 6 7 8 9 10 #include \u0026#34;init.h\u0026#34; void System_Init() { P0 = 0xff; P2 = P2 \u0026amp; 0x1f | 0x80; P2 \u0026amp;= 0x1f; P0 = 0x00; P2 = P2 \u0026amp; 0x1f | 0xa0; P2 \u0026amp;= 0x1f; } init.h 1 2 #include \u0026lt;STC15F2K60S2.H\u0026gt; void System_Init(); mainä¸»å‡½æ•°ä¹¦å†™ main.c ç°åœ¨æˆ‘ä»¬æ¥è¿›è¡Œä¸»å‡½æ•°çš„ç¼–å†™ï¼Œæˆ‘ä¹Ÿæ‹†åˆ†ä¸ºæ¨¡å—ï¼Œä½†æ˜¯æœ€åè¿˜æ˜¯ä¼šç»™ä¸€ä¸ªæ•´ä½“çš„ä»£ç \nå…¨éƒ¨å˜é‡çš„å½’çº³ è¿™é‡Œæˆ‘æŠŠå…¨éƒ¨çš„å…¨å±€å˜é‡æ”¾ä¸Šæ¥\nå®šä¹‰äº†Ledçš„å˜é‡æ•°ç»„ï¼Œç”¨äºæ§åˆ¶8ä¸ªç¯çš„äº®ç­æƒ…å†µ å®šä¹‰äº†Seg_Posçš„å˜é‡ï¼Œç”¨äºæ§åˆ¶æ•°ç ç®¡ä½é€‰æƒ…å†µ å®šä¹‰äº†Seg_Bufçš„å˜é‡æ•°ç»„ï¼Œç”¨äºæ§åˆ¶æ¯ä¸ªæ•°ç ç®¡æ˜¾ç¤ºç¬¬æ•°æ® å®šä¹‰äº†Seg_Pointçš„å˜é‡æ•°ç»„ï¼Œç”¨äºæ§åˆ¶æŸä¸€ä½æ•°ç ç®¡æ˜¯å¦æ˜¾ç¤ºå°æ•°ç‚¹ å®šä¹‰äº†Uart_Bufçš„å˜é‡æ•°ç»„ï¼Œç”¨äºè·å–ä¸²å£æ¥æ”¶çš„æ•°æ® å®šä¹‰äº†Uart_Rx_Indexçš„å˜é‡ï¼Œç”¨äºå¯¹ä¸²å£æ¥æ”¶åçš„æ•°ç»„è¿›è¡Œç´¢å¼• å®šä¹‰äº†Uart_flagçš„å˜é‡ï¼Œç”¨äºåˆ¤æ–­å½“å‰æ˜¯å¦æ­£å¤„äºä¸²å£æ¥æ”¶çŠ¶æ€ å®šä¹‰äº†Sys_Tickçš„å˜é‡ï¼Œç”¨äºå˜€å—’è®¡æ—¶ï¼Œåˆ¤æ–­ä¸²å£æ˜¯å¦æ¥æ”¶çŠ¶æ€è¶…è¿‡äº†10ms å®šä¹‰äº†ucRtcçš„å˜é‡æ•°ç»„ï¼Œç”¨äºå­˜æ”¾æ—¶é’Ÿæ•°æ®ï¼Œæ—¶åˆ†ç§’ å®šä¹‰äº†intå‹çš„è®¡æ—¶å˜é‡time_all_1sï¼Œç”¨äºå…¨å±€å®šæ—¶ å®šä¹‰äº†intå‹çš„é¢‘ç‡å˜é‡Freqï¼Œç”¨äºæµ‹é¢‘ç»“æœçš„å­˜æ”¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /* LEDä¸æ•°ç ç®¡ */ unsigned char ucLed[8] = {0, 0, 0, 0, 0, 0, 0, 0}; unsigned char Seg_Pos; unsigned char Seg_Buf[8] = {10, 10, 10, 10, 10, 10, 10, 10}; unsigned char Seg_Point[8] = {0, 0, 0, 0, 0, 0, 0, 0}; /* ä¸²å£æ•°æ®*/ unsigned char Uart_Buf[10]; unsigned char Uart_Rx_Index; bit Uart_flag; unsigned char Sys_Tick; /* æ—¶é—´*/ unsigned char ucRtc[3] = {11, 11, 11}; unsigned int time_all_1s; /* æ•°æ® */ unsigned int Freq;//ne555æµ‹é¢‘ æ•°æ®è¯»å–æ¨¡å— æˆ‘ä»¬å•ç‹¬å†™ä¸€ä¸ªæ¨¡å—å¯¹æ•°æ®è¿›è¡Œè¯»å–ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œä¸åŒæ•°æ®çš„æ“ä½œï¼Œè¿™é‡Œä½¿ç”¨%çš„æ“ä½œæ¥è¿›è¡Œæ—¶é—´çš„å®šæ—¶ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æ—¶é—´è¯»å–ï¼Œå°±æ¯éš”50msï¼ˆå› ä¸ºæˆ‘å®šæ—¶å™¨æ˜¯1msï¼‰è¿›è¡Œä¸€æ¬¡ï¼›ADè¯»å–æ¯éš”100msä¸€æ¬¡ï¼›æ¸©åº¦è¯»å–æ¯éš”500msä¸€æ¬¡ï¼ˆè¿™é‡Œä»…ä½œå‚è€ƒï¼Œåç»­è¿˜æ˜¯è¦è‡ªå·±æ“ä¸€ä¸‹è¯•è¯•ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 void Data_Proc() if (time_all_1s % 50 == 0) { // æ—¶é—´è¯»å– } if (time_all_1s % 100 == 0) { // ADè¯»å– } if (time_all_1s % 500 == 0) { // æ¸©åº¦è¯»å– } } Keyé”®ç›˜æ¨¡å— è¿™ä¸ªæ¨¡å—æ˜¯é‡ä¸­ä¹‹é‡ï¼Œå› ä¸ºç”¨åˆ°äº†ä¸€ä¸ªå¾ˆç²¾å¦™çš„ä¸‰è¡Œä»£ç æ¶ˆæŠ–æ–¹æ³•ï¼Œè¿™ä¸ªåœ¨æˆ‘ä»¥å‰çš„è§†é¢‘è“æ¡¥æ¯å•ç‰‡æœºæŒ‰é”®è€ƒç‚¹é‡Œé¢æåˆ°è¿‡ï¼Œç‚¹å‡»è¿™è¡Œå­—ä½“å°±å¯ä»¥è·³è½¬è¿‡å»ï¼Œæˆ‘è¿™é‡Œç®€å•è¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„é€»è¾‘å¦‚ä¸‹ï¼ŒKey_Val,Key_Old,Key_Down,Key_Up,è¿™å‡ ä¸ªå˜é‡éƒ½æ˜¯ä¸‹é¢çš„é€»è¾‘ï¼Œæˆ‘ä»¬è¿™é‡Œå¯¹å…¶çš„åŸç†è¿›è¡Œè§£æ\nç¬æ—¶å€¼è·å–-\u0026gt; è·å–æŒ‰ä¸‹çš„å€¼ï¼Œè·å–æŠ¬èµ·çš„å€¼-\u0026gt;æ›´æ–°â¼€ä¸‹å€¼\nDownå’ŒUpéƒ½æ˜¯ç¬æ—¶å€¼ï¼ŒOldæ¯”Valå»¶å10msï¼ŒåŸºäºè¿™ä¸ªç‰¹æ€§æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¹¦å†™ä»£ç \nå¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼Œæˆ‘ä»¬å°†è¿™å››ä¸ªå˜é‡è®¾ç½®ä¸ºé™æ€å±€éƒ¨å˜é‡ï¼Œå¯ä»¥æœ‰æ•ˆèŠ‚çœå†…å­˜ç©ºé—´ï¼Œä½¿ç”¨ifè¯­å¥é‚£ä¸€æ®µè¡¨æ˜æˆ‘ä»¬é€‰æ‹©10msè·‘ä¸€æ¬¡ä»£ç ï¼ˆå› ä¸ºæˆ‘ä»¬å®šæ—¶æ˜¯1msçš„ï¼‰\n1 2 3 4 5 6 7 8 void Key_Proc() { static unsigned char Key_Val, Key_Down, Key_Up, Key_Old; if (time_all_1s % 10) return; Key_Val = Key_Read(); Key_Down = Key_Val \u0026amp; (Key_Old ^ Key_Val); Key_Up = ~Key_Val \u0026amp; (Key_Old ^ Key_Val); Key_Old = Key_Val; } å¦‚æœç†è§£ä¸äº†ä¸Šé¢çš„å›¾å’Œä»£ç ï¼Œæˆ‘å°±æ‹¿ä¸€ä¸ªğŸŒ°æ¥è¿›è¡ŒéªŒè¯ï¼Œæ¯”å¦‚æˆ‘ä»¬æŒ‰ä¸‹/æŠ¬èµ·S4æ¥åšä¸€ä¸‹éªŒè¯\né”®ç›˜çŠ¶æ€ Key_Old Key_Val Key_Old^Key_Val Key_Down Key_Up æœªæŒ‰ä¸‹ 0000 0000 0000^0000=0000 0000 0000 æŒ‰ä¸‹è¿‡ç¨‹ä¸­ï¼ˆ10msï¼‰ 0000 0100 0000^0100=0100 0100\u0026amp;0100=0100 1011\u0026amp;0100=0000 æŒ‰ä¸‹ç¨³å®šï¼ˆ10msåï¼‰ 0100 0100 0100^0100=0000 0100\u0026amp;0000=0000 1011\u0026amp;0000=0000 æŠ¬èµ·è¿‡ç¨‹ï¼ˆ10msï¼‰ 0100 0000 0100^0000=0100 0000\u0026amp;0100=0000 1111\u0026amp;0100=0100 æˆ‘ä»¬å¯ä»¥ä»è¿™é‡Œçœ‹å‡ºï¼Œå½“æˆ‘ä»¬æŒ‰ä¸‹çš„æ—¶å€™ï¼Œé‚£ä¸€ç¬é—´Downä¼šæ˜¯4ï¼ˆæ³¨æ„æ˜¯ä¸€ç¬é—´ï¼‰ï¼Œå…¶ä½™æ—¶å€™éƒ½æ˜¯0ï¼›åŒç†Upä¹Ÿæ˜¯ä¸€æ ·ï¼Œå½“æˆ‘ä»¬æŠ¬èµ·çš„ç¬é—´Upä¼šæ˜¯4ï¼ˆæ³¨æ„æ˜¯ä¸€ç¬é—´ï¼‰ï¼Œå…¶ä½™æ—¶å€™æ˜¯0\né‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åœ¨è¿™ä¸ªä»£ç é‡Œé¢è¿›è¡Œä¹¦å†™å‘¢ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬ä¸€èˆ¬åˆ¤æ–­æŒ‰é”®éƒ½æ˜¯åˆ¤æ–­çš„æŒ‰é”®æŒ‰ä¸‹ï¼Œå³Downçš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŒ‰ç…§ä¸‹é¢è¿™æ ·å†™å°±è¡Œï¼Œä¸‹é¢å°±æ˜¯æŒ‰ä¸‹S4çš„ä¸€ä¸ªç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 void Key_Proc() { static unsigned char Key_Val, Key_Down, Key_Up, Key_Old; if (time_all_1s % 10) return; Key_Val = Key_Read(); Key_Down = Key_Val \u0026amp; (Key_Old ^ Key_Val); Key_Up = ~Key_Val \u0026amp; (Key_Old ^ Key_Val); Key_Old = Key_Val; if(Key_Down == 4) //æ‰§è¡ŒæŒ‰ä¸‹S4çš„å‡½æ•° } Segæ•°ç ç®¡æ¨¡å— è¿™ä¸ªå’ŒV2æ¨¡ç‰ˆä¸ä¸€æ ·ï¼Œä»–å°†æ•°æ®è¯»å–æ”¾å‡ºå»äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ•°ç ç®¡é‡Œé¢ä¸è¿‡å¤šæ¶‰åŠåˆ°æ•°æ®è¯»å–ï¼Œè¿™é‡Œé€‰æ‹©çš„æ˜¯20msè¿›è¡Œä¸€æ¬¡æ•°ç ç®¡çŠ¶æ€æ›´æ–°\n1 2 3 void Seg_Proc() { if (time_all_1s % 20) return; } å¦‚ä½•ä½¿ç”¨å‘¢ï¼Œå…¶å®ä¹Ÿéå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§ä¸‹æ–¹çš„å†™æ³•å³å¯ï¼ˆå› ä¸ºä¸€èˆ¬æ¥è¯´æˆ‘ä»¬éƒ½æœ‰å¤šä¸ªç•Œé¢è¿›è¡Œåˆ‡æ¢ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡Seg_Show_Modeæ¥è¿›è¡Œä¹¦å†™ï¼Œå¦‚æœæœ‰å­ç•Œé¢çš„è¯ï¼Œæ‹¿æˆ‘ä»¬å°±å†å®šä¹‰ä¸€ä¸ªmodeå°±è¡Œï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 void Seg_Proc() { if (time_all_1s % 20) return; switch(Seg_Show_Mode) { case 0: //xxç•Œé¢ Seg_Buf[0] = xx; Seg_Buf[1] = xx; break; case 1: //xxç•Œé¢ break; } } Ledç¯æ¨¡å— è¿™é‡Œé¢æˆ‘çš„è¯ç»å¸¸æ”¾çš„æ˜¯Ledï¼Œèœ‚é¸£å™¨ï¼Œç»§ç”µå™¨ï¼ŒMOTORå£çš„ç›¸å…³é€»è¾‘ï¼Œè¿™é‡Œä¸éœ€è¦è®¾ç½®å®šæ—¶è¿›å…¥\n1 void Led_Proc() {} ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 void Led_Proc() { ucLed[0] = 1;//L1ç‚¹äº® ucLed[1] = 0;//L2ç†„ç­ Relay(1);//æ‰“å¼€ç»§ç”µå™¨ï¼ˆL10äº®ï¼‰ Beep(1);//èœ‚é¸£å™¨å¼€å¯ MOTOR(1);//MOTORè¾“å‡ºé«˜ç”µå¹³ Relay(0);//å…³é—­ç»§ç”µå™¨ï¼ˆL10ç­ï¼‰ Beep(0);//èœ‚é¸£å™¨å…³é—­ MOTOR(0);//MOTORè¾“å‡ºä½ç”µå¹³ } Uartä¸²å£æ¨¡å— æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸²å£è¶…æ—¶è§£æï¼Œå³10mså†…æ²¡æœ‰æ”¶é›†åˆ°ä¸²å£çš„ä¿¡æ¯çš„æ—¶å€™æˆ‘ä»¬æ‰è¿›å…¥å¹¶è¿›è¡Œè§£æï¼ˆåç»­åœ¨å®šæ—¶å™¨é‡Œé¢ä¼šæåˆ°è¿™ä¸ªSys_Tickï¼‰ï¼Œåœ¨æˆ‘ä»¬è§£æç»“æŸåä½¿ç”¨memsetå‡½æ•°å°†æ¥æ”¶çš„æ•°ç»„ç½®ä¸º0ï¼ˆä¸ºäº†é˜²æ­¢åç»­è§£æè¢«å¹²æ‰°ï¼‰ï¼Œå¹¶å°†ç´¢å¼•ç½®ä¸º0ï¼Œä¸ºä¸‹ä¸€æ¬¡æ¥æ”¶è§£æè¿›è¡Œå‡†å¤‡\n1 2 3 4 5 6 7 8 9 void Uart_Proc() { if (Uart_Rx_Index == 0) return; if (Sys_Tick \u0026gt;= 10) { Sys_Tick = Uart_flag = 0; memset(Uart_Buf, 0, Uart_Rx_Index); Uart_Rx_Index = 0; } } ä½¿ç”¨ç¤ºä¾‹ï¼Œè¿™é‡Œå‘é€å°å†™çš„okè¿”å›helloï¼Œæ³¨æ„ä¸€ä¸‹ï¼Œåˆ¤æ–­çš„æ—¶å€™ç”¨çš„æ˜¯å•å¼•å·è€Œä¸æ˜¯åŒå¼•å·\n1 2 3 4 5 6 7 8 9 10 void Uart_Proc() { if (Uart_Rx_Index == 0) return; if (Sys_Tick \u0026gt;= 10) { Sys_Tick = Uart_flag = 0; if(Uart_Buf[0]==\u0026#39;o\u0026#39;\u0026amp;\u0026amp;Uart_Buf[1]==\u0026#39;k\u0026#39;) printf(\u0026#34;hello\u0026#34;); memset(Uart_Buf, 0, Uart_Rx_Index); Uart_Rx_Index = 0; } } å®šæ—¶å™¨0åˆå§‹åŒ–ï¼ˆNE555æ¨¡å—ï¼‰ è¿™ä¸ªæ¨¡å—æ˜¯æœ€æœ‰æ„æ€çš„ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼ŒP34å’Œsingalçš„è·³çº¿å¸½è¦æ’åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”æŒ‰é”®æ–¹é¢éœ€è¦åˆ é™¤P34ï¼Œç„¶åæ‰èƒ½å¼€å§‹æµ‹ï¼Œè¿™é‡Œä¾ç„¶ç”¨ispç”Ÿæˆä¸€ä¸‹åˆå§‹åŒ–çš„å®šæ—¶å™¨0ï¼Œä½†æ˜¯è¿™é‡Œè¦æ³¨æ„ï¼Œæ–°ç‰ˆçš„ä¸èƒ½ç”Ÿæˆ0msï¼Œæˆ‘ä»¬å°±éšä¾¿ç”Ÿæˆä¸ªæ—¶é—´ï¼Œç„¶åæŒ‰ç…§æˆ‘è¿™æ ·å‹¾é€‰åå¤åˆ¶ç²˜è´´å°±è¡Œ\næˆ‘ä»¬éœ€è¦å°†TL0å’ŒTH0çš„å€¼æ”¹ä¸º0ï¼Œå¹¶ä¸”åœ¨TMOD \u0026amp;= 0xF0;ä¸‹é¢å¯¹å…¶è¿›è¡Œé…ç½® TMOD |= 0x05;å°†å…¶å˜ä¸ºåå…­ä½ä¸è‡ªåŠ¨é‡è½½ï¼ˆè¿™é‡Œå…·ä½“å¯ä»¥å‚è€ƒæ‰‹å†Œé‡Œé¢å¯¹äºå®šæ—¶å™¨çš„é…ç½®ï¼Œæˆ‘ä¹‹å‰çš„è§†é¢‘æœ‰æåˆ°è“æ¡¥æ¯å•ç‰‡æœºne555æ¨¡å—ï¼Œç‚¹å‡»å³å¯è§‚çœ‹ï¼‰ï¼Œè¿™é‡Œåˆ«å¿˜äº†EAå¼€å¯æ€»ä¸­æ–­ï¼ˆè¿™æ˜¯æˆ‘çš„ä¹ æƒ¯ï¼‰ï¼Œé¢‘ç‡çš„è¯»å–æ”¾åœ¨å®šæ—¶å™¨1é‚£é‡Œè®²\n1 2 3 4 5 6 7 8 9 10 11 void Timer0_Init(void) // 1æ¯«ç§’@12.000MHz { AUXR \u0026amp;= 0x7F; // å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼ TMOD \u0026amp;= 0xF0; // è®¾ç½®å®šæ—¶å™¨æ¨¡å¼ TMOD |= 0x05; TL0 = 0; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TH0 = 0; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TF0 = 0; // æ¸…é™¤TF0æ ‡å¿— TR0 = 1; // å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶ EA = 1; } å®šæ—¶å™¨1åˆå§‹åŒ– è¿™æ˜¯æˆ‘ä»¬è½®è¯¢çš„å®šæ—¶å™¨çš„åˆå§‹åŒ–ä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨ispç”Ÿæˆ1mså®šæ—¶å™¨1çš„ä»£ç ï¼ˆè®°å¾—å‹¾é€‰ä¸Šä½¿èƒ½ï¼‰ï¼Œè€ç‰ˆæœ¬æ²¡æœ‰ä½¿èƒ½ï¼Œæ‰€ä»¥è®°å¾—åŠ ä¸ŠET1 = 1å¼€å¯\nå½“ç„¶ï¼Œä¸è¦å¿˜è®°EA = 1ï¼Œ\n1 2 3 4 5 6 7 8 9 10 11 void Timer1_Init(void) // 1æ¯«ç§’@12.000MHz { AUXR \u0026amp;= 0xBF; // å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼ TMOD \u0026amp;= 0x0F; // è®¾ç½®å®šæ—¶å™¨æ¨¡å¼ TL1 = 0x18; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TH1 = 0xFC; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TF1 = 0; // æ¸…é™¤TF1æ ‡å¿— TR1 = 1; // å®šæ—¶å™¨1å¼€å§‹è®¡æ—¶ ET1 = 1; // ä½¿èƒ½å®šæ—¶å™¨1ä¸­æ–­ EA = 1; } å®šæ—¶å™¨1ä¸­æ–­ï¼ˆé‡ç‚¹ï¼‰ æˆ‘ä»¬åœ¨è¿™é‡Œæ”¾äº†ä¸€å †ä¸œè¥¿ï¼Œè¿™é‡Œæˆ‘åšä¸€ä¸‹è¯´æ˜ï¼Œæˆ‘ä»¬æ¯ä¸ªä¸­æ–­éƒ½æœ‰å¯¹åº”çš„ä¸­æ–­å·ï¼ˆå¯ä»¥åœ¨å®˜æ–¹çš„æ‰‹å†ŒæŸ¥åˆ°ï¼‰ï¼Œè¿™é‡Œå®šæ—¶å™¨1çš„ä¸­æ–­å·æ˜¯3\nç„¶åæ˜¯æˆ‘ä»¬çš„ä¸€ä¸ªå…¨å±€å®šæ—¶å™¨ï¼ˆ1sï¼Œæ³¨æ„time_all_1sçš„ç±»å‹è¦æ˜¯unsigned intï¼Œä¸ç„¶ä¼šæº¢å‡ºï¼‰ï¼Œåœ¨è¿™ä¸ªå®šæ—¶å™¨é‡Œé¢æˆ‘ä»¬å¯¹é¢‘ç‡è¿›è¡Œäº†è¯»å–ï¼Œå°†TH0 \u0026laquo; 8 | TL0çš„ç»“æœç»™äº†Freqï¼ˆæ³¨æ„ä¸€ä¸‹Freqçš„ç±»å‹è¦æ˜¯unsigned intï¼Œä¸ç„¶ä¼šæº¢å‡ºï¼‰ï¼Œåœ¨æˆ‘ä»¬è¯»å–å®Œæ•°æ®åï¼Œå°†TH0å’ŒTL0è¿›è¡Œäº†ç½®0æ‰‹åŠ¨é‡è½½ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ¬¡è¿›è¡Œæµ‹é‡\næ¥ç€å°±æ˜¯ä¸€ä¸ªå’ŒSys_Tickç›¸å…³çš„ä»£ç ï¼Œå½“æˆ‘ä»¬æ¥æ”¶åˆ°æ•°æ®çš„æ—¶å€™Uart_flagä¼šç½®ä¸º1ï¼Œç„¶åå°†Sys_Tickç½®ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸€æ®µæ—¶é—´ä¸æ¥å—æ•°æ®çš„è¯ï¼Œé‚£ä¹ˆSys_Tickçš„å€¼ä¼šä¸€ç›´ç´¯åŠ ï¼Œç›´åˆ°è¾¾åˆ°10msï¼ˆæˆ‘ä»¬ä¸Šé¢åœ¨Uartä¸²å£æ¨¡å—é‡Œé¢çš„è®¾å®šï¼‰ï¼ŒUart_flagç½®ä¸º0ï¼ŒSys_Tickçš„å€¼ç½®ä¸º0ï¼Œä¸ºä¸‹ä¸€è½®ä¸²å£è§£æåšå‡†å¤‡\nç„¶åå°±æ˜¯æˆ‘ä»¬çš„ä¸€ä¸ªä½é€‰çš„ä»£ç ï¼Œå› ä¸ºæˆ‘ä»¬æ•°ç ç®¡æœ¬è´¨ä¸Šæ˜¯ä¸€ä½ä¸€ä½æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªä½é€‰çš„å˜é‡æ¥è¿›è¡Œä½é€‰ï¼Œè¿™é‡Œä½¿ç”¨çš„Seg_Pos = (++Seg_Pos) % 8å°†Seg_Posè¿™ä¸ªå˜é‡åœ¨0~7ä¸­é—´è¿›è¡Œå¾ªç¯\næ¥ç€å°±æ˜¯æˆ‘ä»¬çš„æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°ï¼Œè¿™é‡Œä¸éœ€è¦å¤šè¯´äº†ï¼Œä¿æŒä»–ä¸å˜å°±è¡Œï¼Œä¼ å…¥ä¸ºä½é€‰ã€ä½é€‰å¯¹åº”çš„æ®µé€‰æ˜¾ç¤ºã€ä½é€‰å¯¹åº”çš„å°æ•°ç‚¹æ˜¾ç¤º\næœ€åå°±æ˜¯æˆ‘ä»¬çš„Ledæ˜¾ç¤ºå‡½æ•°ï¼Œè¿™é‡Œæˆ‘å¹¶æ²¡æœ‰é€‰æ‹©å’Œæ•°ç ç®¡åŒæ­¥ï¼Œè€Œæ˜¯é€‰æ‹©åœ¨ä¸­æ–­é‡Œé¢å†™äº†ä¸ªforå¾ªç¯æ¥è¿›è¡Œæ˜¾ç¤ºï¼Œå› ä¸ºå®ƒä¸æ¶‰åŠåˆ°æ‰«æç­‰æ“ä½œï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å¯ä»¥ç›´æ¥ä¸€èµ·æ˜¾ç¤ºã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 void Timer1_Isr(void) interrupt 3 { unsigned char i; if (++time_all_1s == 1000) { time_all_1s = 0; Freq = TH0 \u0026lt;\u0026lt; 8 | TL0; TH0 = TL0 = 0; } if (Uart_flag) Sys_Tick++; Seg_Pos = (++Seg_Pos) % 8; Seg_Disp(Seg_Pos, Seg_Buf[Seg_Pos], Seg_Point[Seg_Pos]); for (i = 0; i \u0026lt; 8; i++) Led_Disp(i, ucLed[i]); } ä¸²å£ä¸­æ–­ï¼ˆè¿™é‡Œä»£ç å†™æ­»ï¼‰ æˆ‘ä»¬ä¸²å£æœ‰ä¸€ä¸ªæ¥æ”¶ä¸­æ–­ï¼Œä¸²å£1çš„ä¸­æ–­å·æŸ¥è¯¢åå‘ç°ä¸º4\næˆ‘ä»¬ç¬¬ä¸€è¡Œå°±æ˜¯åˆ¤æ–­æ˜¯å¦RIä¸º1ï¼Œå› ä¸ºRIä¸º1åˆ™ä»£è¡¨æœ‰ä¿¡æ¯è¿‡æ¥äº†ï¼Œå½“æˆ‘ä»¬æ”¶é›†åˆ°ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬å°†Uart_flagç½®ä¸º1ï¼ŒSys_Tickç½®ä¸º0ï¼Œå¼€å§‹å˜€å—’è®¡æ—¶ï¼Œå½“æˆ‘ä»¬10msæ²¡æœ‰æ¥æ”¶åˆ°æ–°çš„æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºæ•°æ®æ¥æ”¶å®Œæˆï¼Œå¯ä»¥å¼€å§‹è¿›è¡Œä¸²å£å¤„ç†ï¼Œåé¢çš„æ¥æ”¶å°±ä¸éœ€è¦å¤šè®²äº†ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä½ä¸€ä½è¿›è¡Œæ¥æ”¶çš„ï¼Œè€Œè¯»å†™éƒ½æ˜¯ç”¨çš„SBUFè¿™ä¸ªç¼“å†²åŒºï¼ˆä¸²å£1ï¼Œå¦‚æœæ˜¯ä¸²å£2åˆ™æ˜¯S2BUFï¼Œä½†æ˜¯ä¸²å£2ä¸ä¼šè€ƒï¼Œæ‰€ä»¥è¿™é‡Œä¸ç”¨ç®¡ï¼‰ï¼Œæˆ‘ä»¬æ¥æ”¶å®Œæˆåï¼Œå°†RIç½®ä¸º0ï¼Œä¸ºä¸‹ä¸€æ¬¡æ¥æ”¶åšå‡†å¤‡ï¼Œæœ€åä¸€è¡Œçš„\u0026gt;10æ¸…é›¶ï¼Œåˆ™æ˜¯ä¸ºäº†é¿å…å‡ºç°ä¼ å…¥æ•°æ®æº¢å‡ºï¼Œå¯¼è‡´ç¨‹åºå¼‚å¸¸ï¼Œè¿™é‡Œçš„10å–å†³äºä½ çš„å­—ç¬¦ä¸²æ•°ç»„çš„ä½æ•°ï¼Œæˆ‘åœ¨æœ€ä¸Šé¢å®šçš„æ˜¯10ä½ï¼Œæ‰€ä»¥è¿™é‡Œå†™çš„10\n1 2 3 4 5 6 7 8 9 10 void Uart1_Isr(void) interrupt 4 { if (RI) { Uart_flag = 1; Sys_Tick = 0; Uart_Buf[Uart_Rx_Index] = SBUF; Uart_Rx_Index++; RI = 0; } if (Uart_Rx_Index \u0026gt; 10) Uart_Rx_Index = 0; } mainä¸»å‡½æ•°ä¹¦å†™ è¿™æ˜¯æˆ‘ä»¬çš„ä¸€ä¸ªæœ€åˆçš„å‡½æ•°ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´æ˜çš„ï¼Œå°±æ˜¯éœ€è¦è¿›è¡Œä¸€äº›åˆå§‹åŒ–è€Œå·²ï¼Œä½†æ˜¯é¡ºåºä¸è¦å†™é”™äº†ï¼Œé¦–å…ˆæ˜¯ç³»ç»Ÿåˆå§‹åŒ–ï¼Œç„¶åæ˜¯å®šæ—¶å™¨0ï¼ˆne555ï¼‰ï¼Œæœ€åæ˜¯å®šæ—¶å™¨1ï¼ˆè½®è¯¢ï¼‰çš„åˆå§‹åŒ–ã€‚\nä½ å¯ä»¥å‘ç°ï¼Œæˆ‘åœ¨è¿™é‡Œè¿›è¡Œäº†ä¸€æ¬¡æ¸©åº¦çš„ç©ºè¯»å–ï¼Œå› ä¸ºæ¸©åº¦ä¸Šç”µåä¼šæ˜¾ç¤º85ï¼ˆæ¸©åº¦è½¬æ¢çš„æ—¶é—´ï¼‰ï¼Œå¦‚æœåœ¨åé¢æ‰ç»™ä»–å¼€å§‹æ¸©åº¦è½¬æ¢çš„è¯ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½è·³85ï¼Œå¯¼è‡´æµ‹é‡ç»“æœé”™è¯¯ï¼Œè¿™é‡Œçš„å»¶æ—¶å‡½æ•°ä¹Ÿæ˜¯ç”¨ispç›´æ¥ç”Ÿæˆçš„ï¼Œæ³¨æ„ç³»ç»Ÿæ—¶é—´åˆ«é€‰é”™äº†å°±è¡Œ\næˆ‘ä»¬å†™å®Œåˆå§‹åŒ–ä¹‹åå°±éœ€è¦å†™ä¸€ä¸‹å¾ªç¯äº†ï¼Œ51å•ç‰‡æœºé‡Œé¢å¿…é¡»å°†å¾ªç¯å†™æ­»ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨äº†while(1)ï¼Œè¿™é‡Œçš„é¡ºåºå€’æ²¡ä»€ä¹ˆç‰¹æ®Šçš„è¦æ±‚ï¼Œä½†æ˜¯å°½é‡æŒ‰ç…§æˆ‘è¿™ä¸ªé¡ºåºå°±è¡Œï¼Œä¸ä¼šå‡ºé—®é¢˜çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 void main() { System_Init(); Timer0_Init(); Timer1_Init(); Set_Rtc(ucRtc); rd_temperature(); Delay750ms(); while (1) { Data_Proc(); Key_Proc(); Seg_Proc(); Uart_Proc(); Led_Proc(); } } å®Œæ•´çš„main.c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 #include \u0026#34;main.h\u0026#34; /* LEDä¸æ•°ç ç®¡ */ unsigned char ucLed[8] = {0, 0, 0, 0, 0, 0, 0, 0}; unsigned char Seg_Pos; unsigned char Seg_Buf[8] = {10, 10, 10, 10, 10, 10, 10, 10}; unsigned char Seg_Point[8] = {0, 0, 0, 0, 0, 0, 0, 0}; /* ä¸²å£æ•°æ®*/ unsigned char Uart_Buf[10]; unsigned char Uart_Rx_Index; bit Uart_flag; unsigned char Sys_Tick; /* æ—¶é—´*/ unsigned char ucRtc[3] = {11, 11, 11}; unsigned int time_all_1s; /* æ•°æ® */ unsigned int Freq; void Data_Proc() { if (time_all_1s % 50 == 0) { // æ—¶é—´è¯»å– } if (time_all_1s % 100 == 0) { // ADè¯»å– } if (time_all_1s % 500 == 0) { // æ¸©åº¦è¯»å– } } /* é”®ç›˜å¤„ç†*/ void Key_Proc() { static unsigned char Key_Val, Key_Down, Key_Up, Key_Old; if (time_all_1s % 10) return; Key_Val = Key_Read(); Key_Down = Key_Val \u0026amp; (Key_Old ^ Key_Val); Key_Up = ~Key_Val \u0026amp; (Key_Old ^ Key_Val); Key_Old = Key_Val; } /* æ•°ç ç®¡å¤„ç†*/ void Seg_Proc() { if (time_all_1s % 20) return; } void Led_Proc() {} void Uart_Proc() { if (Uart_Rx_Index == 0) return; if (Sys_Tick \u0026gt;= 10) { Sys_Tick = Uart_flag = 0; memset(Uart_Buf, 0, Uart_Rx_Index); Uart_Rx_Index = 0; } } void Timer0_Init(void) // 1æ¯«ç§’@12.000MHz { AUXR \u0026amp;= 0x7F; // å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼ TMOD \u0026amp;= 0xF0; // è®¾ç½®å®šæ—¶å™¨æ¨¡å¼ TMOD |= 0x05; TL0 = 0; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TH0 = 0; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TF0 = 0; // æ¸…é™¤TF0æ ‡å¿— TR0 = 1; // å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶ EA = 1; } void Timer1_Init(void) // 1æ¯«ç§’@12.000MHz { AUXR \u0026amp;= 0xBF; // å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼ TMOD \u0026amp;= 0x0F; // è®¾ç½®å®šæ—¶å™¨æ¨¡å¼ TL1 = 0x18; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TH1 = 0xFC; // è®¾ç½®å®šæ—¶åˆå§‹å€¼ TF1 = 0; // æ¸…é™¤TF1æ ‡å¿— TR1 = 1; // å®šæ—¶å™¨1å¼€å§‹è®¡æ—¶ ET1 = 1; // ä½¿èƒ½å®šæ—¶å™¨1ä¸­æ–­ EA = 1; } void Timer1_Isr(void) interrupt 3 { unsigned char i; if (++time_all_1s == 1000) { time_all_1s = 0; Freq = TH0 \u0026lt;\u0026lt; 8 | TL0; TH0 = TL0 = 0; } if (Uart_flag) Sys_Tick++; Seg_Pos = (++Seg_Pos) % 8; Seg_Disp(Seg_Pos, Seg_Buf[Seg_Pos], Seg_Point[Seg_Pos]); for (i = 0; i \u0026lt; 8; i++) Led_Disp(i, ucLed[i]); } void Uart1_Isr(void) interrupt 4 { if (RI) { Uart_flag = 1; Sys_Tick = 0; Uart_Buf[Uart_Rx_Index] = SBUF; Uart_Rx_Index++; RI = 0; } if (Uart_Rx_Index \u0026gt; 10) Uart_Rx_Index = 0; } void Delay750ms(void) //@12.000MHz { unsigned char data i, j, k; _nop_(); _nop_(); i = 35; j = 51; k = 182; do { do { while (--k); } while (--j); } while (--i); } void main() { System_Init(); Timer0_Init(); Timer1_Init(); Set_Rtc(ucRtc); rd_temperature(); Delay750ms(); while (1) { Data_Proc(); Key_Proc(); Seg_Proc(); Uart_Proc(); Led_Proc(); } } main.h 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #include \u0026lt;STC15F2K60S2.H\u0026gt; #include \u0026#34;ds1302.h\u0026#34; #include \u0026#34;iic.h\u0026#34; #include \u0026#34;init.h\u0026#34; #include \u0026#34;intrins.h\u0026#34; #include \u0026#34;key.h\u0026#34; #include \u0026#34;led.h\u0026#34; #include \u0026#34;onewire.h\u0026#34; #include \u0026#34;seg.h\u0026#34; #include \u0026#34;stdio.h\u0026#34; #include \u0026#34;string.h\u0026#34; #include \u0026#34;uart.h\u0026#34; #include \u0026#34;ul.h\u0026#34; ","date":"0001-01-01T00:00:00Z","permalink":"https://zuoliangyu.github.io/p/%E8%93%9D%E6%A1%A5%E6%9D%AF/","title":"è“æ¡¥æ¯æ¨¡æ¿å»ºç«‹"}]